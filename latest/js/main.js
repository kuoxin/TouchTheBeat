define("util/analytics",["jquery","underscore","backbone","google-analytics"],function(e,t,n,r){var i={};return i.trackPageView=function(e){r("send","pageview",e.fragment==""?"/":e.fragment)},i.trackAction=function(e,t,n,i){r("send","event",e,t,n,i)},r("create","UA-52163376-2","auto"),i}),define("app",["jquery","underscore","backbone","router","util/analytics","bootstrap"],function(e,t,n,r,i){var s={router:null,applicationwithmenuisrendered:!1,currentview:null,startlevel:function(e){s.setFullScreenContent(s.router.playlevelview,e)},setFullScreenContent:function(){console.log(arguments),s.router.applicationwithmenuisrendered=!1,s.currentview=[].shift.call(arguments),s.currentview.setElement("#body").render.apply(s.currentview,arguments),i.trackPageView(s.router.current())},setContent:function(){s.router.applicationwithmenuisrendered||(s.router.applicationwithmenuview.render(),s.router.applicationwithmenuisrendered=!0),s.currentview!=null&&(s.currentview.onClose&&s.currentview.onClose(),s.currentview.dispose()),s.currentview=[].shift.call(arguments),s.currentview.setElement(e("#content")).render.apply(s.currentview,arguments),i.trackPageView(s.router.current())}};return s}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.12",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("ï»¿")===0&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!templates/menu.html",[],function(){return'		<div class="container">\r\n			<div class="navbar-header">\r\n				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">\r\n					<span class="icon-bar"></span>\r\n					<span class="icon-bar"></span>\r\n					<span class="icon-bar"></span>\r\n				</button>\r\n				<a class="navbar-brand" href="#/">TouchTheBeat</a>\r\n			</div>\r\n			<div class="navbar-collapse collapse">\r\n				<ul class="nav navbar-nav">\r\n					<li id="home"><a href="#">Home</a>\r\n					</li>\r\n					<li id="chooselevel"><a href="#chooselevel">Play</a>\r\n					</li>\r\n					<li id="buildlevel"><a href="#buildlevel">Level Generator</a>\r\n					</li>\r\n					<li class="dropdown">\r\n						<a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>\r\n						<ul class="dropdown-menu">\r\n                            <li><a href="//github.com/hstolte/TouchTheBeat" target="_blank" ><span class="glyphicon glyphicon-share"></span> Project on GitHub</a>\r\n                            </li>\r\n                            <li><a href="//trello.com/b/uJHkG6xQ" target="_blank"><span\r\n                                    class="glyphicon glyphicon-share"></span> Trello Board</a></li>\r\n                            <li><a href="//twitter.com/intent/tweet?text=.@TouchTheBeat " target="_blank"><span\r\n                                    class="glyphicon glyphicon-share"></span> Give Feedback</a>\r\n                            </li>\r\n\r\n							<li class="divider"></li>\r\n\r\n                            <li><a href="#legal">Legal information</a>\r\n                            </li>\r\n						</ul>\r\n					</li>\r\n				</ul>\r\n				<!--<form class="navbar-form navbar-right">\r\n                      <div class="form-group">\r\n                        <input type="text" placeholder="Email" class="form-control">\r\n                      </div>\r\n                      <div class="form-group">\r\n                        <input type="password" placeholder="Password" class="form-control">\r\n                      </div>\r\n                      <button type="submit" class="btn btn-success">Sign in</button>\r\n                    </form>-->\r\n			</div>\r\n			<!--/.navbar-collapse -->\r\n		</div>'}),define("views/menu",["jquery","underscore","backbone","text!templates/menu.html","bootstrap"],function(e,t,n,r){var i=n.View.extend({el:"#menu",render:function(){this.closemenuitem&&this.closemenuitem.unbind();var i=t.template(r,{});this.$el.html(i),this.closemenuitem=e(".navbar-collapse ul li a:not(.dropdown-toggle)"),this.closemenuitem.bind("click",function(){e(".navbar-toggle:visible").click()}),n.history.bind("route",this.updateMenuState)},updateMenuState:function(t,n){var r=e(".active");r!=null&&r.removeClass("active");var i=e("#"+n);i!=null&&i.addClass("active")}});return i}),define("text!templates/home.html",[],function(){return'<div class="container">  \r\n<!-- Main jumbotron for a primary marketing message or call to action -->\r\n    <div class="jumbotron">\r\n      <div class="container">\r\n        <h1>TouchTheBeat</h1>\r\n        <p>TouchTheBeat is a HTML5 multi-touch music game currently <strong>in development</strong>. </p>\r\n        <p><a href="#/chooselevel" class="btn btn-primary btn-lg">Try TouchTheBeat &raquo;</a></p>\r\n      </div>\r\n    </div>\r\n\r\n      <!-- Example row of columns -->\r\n      <div class="row">\r\n        <div class="col-lg-4">\r\n            <h2>The Game</h2>\r\n            <p>TouchTheBeat is <strong>level-based</strong>. Each level consists of a song and a composition of interactive objects. The objects can be either tapped, <del>hold, dragged or slided</del><i> (soon)</i>. The more <strong>rhythmically accurate</strong> you interact with the objects, the more points you get in the end.</p>\r\n          \r\n        </div>\r\n          <div class="col-lg-4">\r\n              <h2>The Level-Builder</h2>\r\n              <p>You can easily create your own levels by using any <strong>SoundCloud track</strong> as music for your level. When finished, you might share and exchange your levels online in text-format. This way it is easy to <strong>play levels created by others</strong>.</p>\r\n              <p><a class="btn btn-default pull-right" href="#/buildlevel">Build a level &raquo;</a></p>\r\n          </div>\r\n        <div class="col-lg-4">\r\n          <h2>Development</h2>\r\n            <p>TouchTheBeat is currently in active development and you are testing an <strong>early version</strong>. The finished game may be completely different than the current version. I am glad about every <strong>feedback</strong> you may give to me. You can give feedback by pressing the button below.</p>\r\n\r\n            <p><a class="btn btn-default pull-right" href="//twitter.com/intent/tweet?text=.@TouchTheBeat "\r\n                  target="_blank">Give Feedback</a></p>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n'}),define("views/home",["jquery","underscore","backbone","text!templates/home.html"],function(e,t,n,r){var i=n.View.extend({el:"#content",render:function(){var e=t.template(r,{});this.$el.html(e)}});return i}),function(e,t){typeof define=="function"&&define.amd?define("tv4",[],t):typeof module!="undefined"&&module.exports?module.exports=t():e.tv4=t()}(this,function(){function t(e,n){if(e===n)return!0;if(typeof e=="object"&&typeof n=="object"){if(Array.isArray(e)!==Array.isArray(n))return!1;if(Array.isArray(e)){if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r],n[r]))return!1}else{var i;for(i in e)if(n[i]===undefined&&e[i]!==undefined)return!1;for(i in n)if(e[i]===undefined&&n[i]!==undefined)return!1;for(i in e)if(!t(e[i],n[i]))return!1}return!0}return!1}function n(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null}function r(e,t){function r(e){var t=[];return e.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){e==="/.."?t.pop():t.push(e)}),t.join("").replace(/^\//,e.charAt(0)==="/"?"/":"")}return t=n(t||""),e=n(e||""),!t||!e?null:(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+r(t.protocol||t.authority||t.pathname.charAt(0)==="/"?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname)+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash}function i(e){return e.split("#")[0]}function s(e,t){if(e&&typeof e=="object"){t===undefined?t=e.id:typeof e.id=="string"&&(t=r(t,e.id),e.id=t);if(Array.isArray(e))for(var n=0;n<e.length;n++)s(e[n],t);else{typeof e["$ref"]=="string"&&(e.$ref=r(t,e.$ref));for(var i in e)i!=="enum"&&s(e[i],t)}}}function l(e,t,n,r,i){Error.call(this);if(e===undefined)throw new Error("No code supplied for error: "+t);this.message=t,this.code=e,this.dataPath=n||"",this.schemaPath=r||"",this.subErrors=i||null;var s=new Error(this.message);this.stack=s.stack||s.stacktrace;if(!this.stack)try{throw s}catch(s){this.stack=s.stack||s.stacktrace}}function c(e,t){if(t.substring(0,e.length)===e){var n=t.substring(e.length);if(t.length>0&&t.charAt(e.length-1)==="/"||n.charAt(0)==="#"||n.charAt(0)==="?")return!0}return!1}function p(t){var n=new e,a=t||"en",l={addFormat:function(){n.addFormat.apply(n,arguments)},language:function(e){return e?(h[e]||(e=e.split("-")[0]),h[e]?(a=e,e):!1):a},addLanguage:function(e,t){var n;for(n in o)t[n]&&!t[o[n]]&&(t[o[n]]=t[n]);var r=e.split("-")[0];if(!h[r])h[e]=t,h[r]=t;else{h[e]=Object.create(h[r]);for(n in t)typeof h[r][n]=="undefined"&&(h[r][n]=t[n]),h[e][n]=t[n]}return this},freshApi:function(e){var t=p();return e&&t.language(e),t},validate:function(t,r,i,s){var o=new e(n,!1,h[a],i,s);typeof r=="string"&&(r={$ref:r}),o.addSchema("",r);var u=o.validateAll(t,r,null,null,"");return!u&&s&&(u=o.banUnknownProperties()),this.error=u,this.missing=o.missing,this.valid=u===null,this.valid},validateResult:function(){var e={};return this.validate.apply(e,arguments),e},validateMultiple:function(t,r,i,s){var o=new e(n,!0,h[a],i,s);typeof r=="string"&&(r={$ref:r}),o.addSchema("",r),o.validateAll(t,r,null,null,""),s&&o.banUnknownProperties();var u={};return u.errors=o.errors,u.missing=o.missing,u.valid=u.errors.length===0,u},addSchema:function(){return n.addSchema.apply(n,arguments)},getSchema:function(){return n.getSchema.apply(n,arguments)},getSchemaMap:function(){return n.getSchemaMap.apply(n,arguments)},getSchemaUris:function(){return n.getSchemaUris.apply(n,arguments)},getMissingUris:function(){return n.getMissingUris.apply(n,arguments)},dropSchemas:function(){n.dropSchemas.apply(n,arguments)},defineKeyword:function(){n.defineKeyword.apply(n,arguments)},defineError:function(e,t,n){if(typeof e!="string"||!/^[A-Z]+(_[A-Z]+)*$/.test(e))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if(typeof t!="number"||t%1!==0||t<1e4)throw new Error("Code number must be an integer > 10000");if(typeof o[e]!="undefined")throw new Error("Error already defined: "+e+" as "+o[e]);if(typeof u[t]!="undefined")throw new Error("Error code already used: "+u[t]+" as "+t);o[e]=t,u[t]=e,f[e]=f[t]=n;for(var r in h){var i=h[r];i[e]&&(i[t]=i[t]||i[e])}},reset:function(){n.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:s,resolveUrl:r,getDocumentUri:i,errorCodes:o};return l}Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if(typeof i!="object"&&typeof i!="function"||i===null)throw new TypeError("Object.keys called on non-object");var s=[];for(var o in i)e.call(i,o)&&s.push(o);if(t)for(var u=0;u<r;u++)e.call(i,n[u])&&s.push(n[u]);return s}}()),Object.create||(Object.create=function(){function e(){}return function(t){if(arguments.length!==1)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>1&&(r=Number(arguments[1]),r!==r?r=0:r!==0&&r!==Infinity&&r!==-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),Object.isFrozen||(Object.isFrozen=function(e){var t="tv4_test_frozen_key";while(e.hasOwnProperty(t))t+=Math.random();try{return e[t]=!0,delete e[t],!1}catch(n){return!0}});var e=function(t,n,r,i,s){this.missing=[],this.missingMap={},this.formatValidators=t?Object.create(t.formatValidators):{},this.schemas=t?Object.create(t.schemas):{},this.collectMultiple=n,this.errors=[],this.handleError=n?this.collectError:this.returnError,i&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),s&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=r,this.definedKeywords={};if(t)for(var o in t.definedKeywords)this.definedKeywords[o]=t.definedKeywords[o].slice(0)};e.prototype.defineKeyword=function(e,t){this.definedKeywords[e]=this.definedKeywords[e]||[],this.definedKeywords[e].push(t)},e.prototype.createError=function(e,t,n,r,i){var s=this.errorMessages[e]||f[e];if(typeof s!="string")return new l(e,"Unknown error code "+e+": "+JSON.stringify(t),n,r,i);var o=s.replace(/\{([^{}]*)\}/g,function(e,n){var r=t[n];return typeof r=="string"||typeof r=="number"?r:e});return new l(e,o,n,r,i)},e.prototype.returnError=function(e){return e},e.prototype.collectError=function(e){return e&&this.errors.push(e),null},e.prototype.prefixErrors=function(e,t,n){for(var r=e;r<this.errors.length;r++)this.errors[r]=this.errors[r].prefixWith(t,n);return this},e.prototype.banUnknownProperties=function(){for(var e in this.unknownPropertyPaths){var t=this.createError(o.UNKNOWN_PROPERTY,{path:e},e,""),n=this.handleError(t);if(n)return n}return null},e.prototype.addFormat=function(e,t){if(typeof e=="object"){for(var n in e)this.addFormat(n,e[n]);return this}this.formatValidators[e]=t},e.prototype.resolveRefs=function(e,t){if(e.$ref!==undefined){t=t||{};if(t[e.$ref])return this.createError(o.CIRCULAR_REFERENCE,{urls:Object.keys(t).join(", ")},"","");t[e.$ref]=!0,e=this.getSchema(e.$ref,t)}return e},e.prototype.getSchema=function(e,t){var n;if(this.schemas[e]!==undefined)return n=this.schemas[e],this.resolveRefs(n,t);var r=e,i="";e.indexOf("#")!==-1&&(i=e.substring(e.indexOf("#")+1),r=e.substring(0,e.indexOf("#")));if(typeof this.schemas[r]=="object"){n=this.schemas[r];var s=decodeURIComponent(i);if(s==="")return this.resolveRefs(n,t);if(s.charAt(0)!=="/")return undefined;var o=s.split("/").slice(1);for(var u=0;u<o.length;u++){var a=o[u].replace(/~1/g,"/").replace(/~0/g,"~");if(n[a]===undefined){n=undefined;break}n=n[a]}if(n!==undefined)return this.resolveRefs(n,t)}this.missing[r]===undefined&&(this.missing.push(r),this.missing[r]=r,this.missingMap[r]=r)},e.prototype.searchSchemas=function(e,t){if(e&&typeof e=="object"){typeof e.id=="string"&&c(t,e.id)&&this.schemas[e.id]===undefined&&(this.schemas[e.id]=e);for(var n in e)if(n!=="enum")if(typeof e[n]=="object")this.searchSchemas(e[n],t);else if(n==="$ref"){var r=i(e[n]);r&&this.schemas[r]===undefined&&this.missingMap[r]===undefined&&(this.missingMap[r]=r)}}},e.prototype.addSchema=function(e,t){if(typeof e!="string"||typeof t=="undefined"){if(typeof e!="object"||typeof e.id!="string")return;t=e,e=t.id}e===i(e)+"#"&&(e=i(e)),this.schemas[e]=t,delete this.missingMap[e],s(t,e),this.searchSchemas(t,e)},e.prototype.getSchemaMap=function(){var e={};for(var t in this.schemas)e[t]=this.schemas[t];return e},e.prototype.getSchemaUris=function(e){var t=[];for(var n in this.schemas)(!e||e.test(n))&&t.push(n);return t},e.prototype.getMissingUris=function(e){var t=[];for(var n in this.missingMap)(!e||e.test(n))&&t.push(n);return t},e.prototype.dropSchemas=function(){this.schemas={},this.reset()},e.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},e.prototype.validateAll=function(e,t,n,r,i){var s;t=this.resolveRefs(t);if(!t)return null;if(t instanceof l)return this.errors.push(t),t;var o=this.errors.length,u,a=null,f=null;if(this.checkRecursive&&e&&typeof e=="object"){s=!this.scanned.length;if(e[this.validatedSchemasKey]){var c=e[this.validatedSchemasKey].indexOf(t);if(c!==-1)return this.errors=this.errors.concat(e[this.validationErrorsKey][c]),null}if(Object.isFrozen(e)){u=this.scannedFrozen.indexOf(e);if(u!==-1){var h=this.scannedFrozenSchemas[u].indexOf(t);if(h!==-1)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[u][h]),null}}this.scanned.push(e);if(Object.isFrozen(e))u===-1&&(u=this.scannedFrozen.length,this.scannedFrozen.push(e),this.scannedFrozenSchemas.push([])),a=this.scannedFrozenSchemas[u].length,this.scannedFrozenSchemas[u][a]=t,this.scannedFrozenValidationErrors[u][a]=[];else{if(!e[this.validatedSchemasKey])try{Object.defineProperty(e,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(e,this.validationErrorsKey,{value:[],configurable:!0})}catch(p){e[this.validatedSchemasKey]=[],e[this.validationErrorsKey]=[]}f=e[this.validatedSchemasKey].length,e[this.validatedSchemasKey][f]=t,e[this.validationErrorsKey][f]=[]}}var d=this.errors.length,v=this.validateBasic(e,t,i)||this.validateNumeric(e,t,i)||this.validateString(e,t,i)||this.validateArray(e,t,i)||this.validateObject(e,t,i)||this.validateCombinations(e,t,i)||this.validateFormat(e,t,i)||this.validateDefinedKeywords(e,t,i)||null;if(s){while(this.scanned.length){var m=this.scanned.pop();delete m[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(v||d!==this.errors.length)while(n&&n.length||r&&r.length){var g=n&&n.length?""+n.pop():null,y=r&&r.length?""+r.pop():null;v&&(v=v.prefixWith(g,y)),this.prefixErrors(d,g,y)}return a!==null?this.scannedFrozenValidationErrors[u][a]=this.errors.slice(o):f!==null&&(e[this.validationErrorsKey][f]=this.errors.slice(o)),this.handleError(v)},e.prototype.validateFormat=function(e,t){if(typeof t.format!="string"||!this.formatValidators[t.format])return null;var n=this.formatValidators[t.format].call(null,e,t);return typeof n=="string"||typeof n=="number"?this.createError(o.FORMAT_CUSTOM,{message:n}).prefixWith(null,"format"):n&&typeof n=="object"?this.createError(o.FORMAT_CUSTOM,{message:n.message||"?"},n.dataPath||null,n.schemaPath||"/format"):null},e.prototype.validateDefinedKeywords=function(e,t){for(var n in this.definedKeywords){if(typeof t[n]=="undefined")continue;var r=this.definedKeywords[n];for(var i=0;i<r.length;i++){var s=r[i],u=s(e,t[n],t);if(typeof u=="string"||typeof u=="number")return this.createError(o.KEYWORD_CUSTOM,{key:n,message:u}).prefixWith(null,"format");if(u&&typeof u=="object"){var a=u.code||o.KEYWORD_CUSTOM;if(typeof a=="string"){if(!o[a])throw new Error("Undefined error code (use defineError): "+a);a=o[a]}var f=typeof u.message=="object"?u.message:{key:n,message:u.message||"?"},l=u.schemaPath||"/"+n.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(a,f,u.dataPath||null,l)}}}return null},e.prototype.validateBasic=function(t,n,r){var i;return(i=this.validateType(t,n,r))?i.prefixWith(null,"type"):(i=this.validateEnum(t,n,r))?i.prefixWith(null,"type"):null},e.prototype.validateType=function(t,n){if(n.type===undefined)return null;var r=typeof t;t===null?r="null":Array.isArray(t)&&(r="array");var i=n.type;typeof i!="object"&&(i=[i]);for(var s=0;s<i.length;s++){var u=i[s];if(u===r||u==="integer"&&r==="number"&&t%1===0)return null}return this.createError(o.INVALID_TYPE,{type:r,expected:i.join("/")})},e.prototype.validateEnum=function(n,r){if(r["enum"]===undefined)return null;for(var i=0;i<r["enum"].length;i++){var s=r["enum"][i];if(t(n,s))return null}return this.createError(o.ENUM_MISMATCH,{value:typeof JSON!="undefined"?JSON.stringify(n):n})},e.prototype.validateNumeric=function(t,n,r){return this.validateMultipleOf(t,n,r)||this.validateMinMax(t,n,r)||null},e.prototype.validateMultipleOf=function(t,n){var r=n.multipleOf||n.divisibleBy;return r===undefined?null:typeof t=="number"&&t%r!==0?this.createError(o.NUMBER_MULTIPLE_OF,{value:t,multipleOf:r}):null},e.prototype.validateMinMax=function(t,n){if(typeof t!="number")return null;if(n.minimum!==undefined){if(t<n.minimum)return this.createError(o.NUMBER_MINIMUM,{value:t,minimum:n.minimum}).prefixWith(null,"minimum");if(n.exclusiveMinimum&&t===n.minimum)return this.createError(o.NUMBER_MINIMUM_EXCLUSIVE,{value:t,minimum:n.minimum}).prefixWith(null,"exclusiveMinimum")}if(n.maximum!==undefined){if(t>n.maximum)return this.createError(o.NUMBER_MAXIMUM,{value:t,maximum:n.maximum}).prefixWith(null,"maximum");if(n.exclusiveMaximum&&t===n.maximum)return this.createError(o.NUMBER_MAXIMUM_EXCLUSIVE,{value:t,maximum:n.maximum}).prefixWith(null,"exclusiveMaximum")}return null},e.prototype.validateString=function(t,n,r){return this.validateStringLength(t,n,r)||this.validateStringPattern(t,n,r)||null},e.prototype.validateStringLength=function(t,n){return typeof t!="string"?null:n.minLength!==undefined&&t.length<n.minLength?this.createError(o.STRING_LENGTH_SHORT,{length:t.length,minimum:n.minLength}).prefixWith(null,"minLength"):n.maxLength!==undefined&&t.length>n.maxLength?this.createError(o.STRING_LENGTH_LONG,{length:t.length,maximum:n.maxLength}).prefixWith(null,"maxLength"):null},e.prototype.validateStringPattern=function(t,n){if(typeof t!="string"||n.pattern===undefined)return null;var r=new RegExp(n.pattern);return r.test(t)?null:this.createError(o.STRING_PATTERN,{pattern:n.pattern}).prefixWith(null,"pattern")},e.prototype.validateArray=function(t,n,r){return Array.isArray(t)?this.validateArrayLength(t,n,r)||this.validateArrayUniqueItems(t,n,r)||this.validateArrayItems(t,n,r)||null:null},e.prototype.validateArrayLength=function(t,n){var r;if(n.minItems!==undefined&&t.length<n.minItems){r=this.createError(o.ARRAY_LENGTH_SHORT,{length:t.length,minimum:n.minItems}).prefixWith(null,"minItems");if(this.handleError(r))return r}if(n.maxItems!==undefined&&t.length>n.maxItems){r=this.createError(o.ARRAY_LENGTH_LONG,{length:t.length,maximum:n.maxItems}).prefixWith(null,"maxItems");if(this.handleError(r))return r}return null},e.prototype.validateArrayUniqueItems=function(n,r){if(r.uniqueItems)for(var i=0;i<n.length;i++)for(var s=i+1;s<n.length;s++)if(t(n[i],n[s])){var u=this.createError(o.ARRAY_UNIQUE,{match1:i,match2:s}).prefixWith(null,"uniqueItems");if(this.handleError(u))return u}return null},e.prototype.validateArrayItems=function(t,n,r){if(n.items===undefined)return null;var i,s;if(Array.isArray(n.items)){for(s=0;s<t.length;s++)if(s<n.items.length){if(i=this.validateAll(t[s],n.items[s],[s],["items",s],r+"/"+s))return i}else if(n.additionalItems!==undefined)if(typeof n.additionalItems=="boolean"){if(!n.additionalItems){i=this.createError(o.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+s,"additionalItems");if(this.handleError(i))return i}}else if(i=this.validateAll(t[s],n.additionalItems,[s],["additionalItems"],r+"/"+s))return i}else for(s=0;s<t.length;s++)if(i=this.validateAll(t[s],n.items,[s],["items"],r+"/"+s))return i;return null},e.prototype.validateObject=function(t,n,r){return typeof t!="object"||t===null||Array.isArray(t)?null:this.validateObjectMinMaxProperties(t,n,r)||this.validateObjectRequiredProperties(t,n,r)||this.validateObjectProperties(t,n,r)||this.validateObjectDependencies(t,n,r)||null},e.prototype.validateObjectMinMaxProperties=function(t,n){var r=Object.keys(t),i;if(n.minProperties!==undefined&&r.length<n.minProperties){i=this.createError(o.OBJECT_PROPERTIES_MINIMUM,{propertyCount:r.length,minimum:n.minProperties}).prefixWith(null,"minProperties");if(this.handleError(i))return i}if(n.maxProperties!==undefined&&r.length>n.maxProperties){i=this.createError(o.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:r.length,maximum:n.maxProperties}).prefixWith(null,"maxProperties");if(this.handleError(i))return i}return null},e.prototype.validateObjectRequiredProperties=function(t,n){if(n.required!==undefined)for(var r=0;r<n.required.length;r++){var i=n.required[r];if(t[i]===undefined){var s=this.createError(o.OBJECT_REQUIRED,{key:i}).prefixWith(null,""+r).prefixWith(null,"required");if(this.handleError(s))return s}}return null},e.prototype.validateObjectProperties=function(t,n,r){var i;for(var s in t){var u=r+"/"+s.replace(/~/g,"~0").replace(/\//g,"~1"),a=!1;if(n.properties!==undefined&&n.properties[s]!==undefined){a=!0;if(i=this.validateAll(t[s],n.properties[s],[s],["properties",s],u))return i}if(n.patternProperties!==undefined)for(var f in n.patternProperties){var l=new RegExp(f);if(l.test(s)){a=!0;if(i=this.validateAll(t[s],n.patternProperties[f],[s],["patternProperties",f],u))return i}}if(!a)if(n.additionalProperties!==undefined){this.trackUnknownProperties&&(this.knownPropertyPaths[u]=!0,delete this.unknownPropertyPaths[u]);if(typeof n.additionalProperties=="boolean"){if(!n.additionalProperties){i=this.createError(o.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(s,"additionalProperties");if(this.handleError(i))return i}}else if(i=this.validateAll(t[s],n.additionalProperties,[s],["additionalProperties"],u))return i}else this.trackUnknownProperties&&!this.knownPropertyPaths[u]&&(this.unknownPropertyPaths[u]=!0);else this.trackUnknownProperties&&(this.knownPropertyPaths[u]=!0,delete this.unknownPropertyPaths[u])}return null},e.prototype.validateObjectDependencies=function(t,n,r){var i;if(n.dependencies!==undefined)for(var s in n.dependencies)if(t[s]!==undefined){var u=n.dependencies[s];if(typeof u=="string"){if(t[u]===undefined){i=this.createError(o.OBJECT_DEPENDENCY_KEY,{key:s,missing:u}).prefixWith(null,s).prefixWith(null,"dependencies");if(this.handleError(i))return i}}else if(Array.isArray(u))for(var a=0;a<u.length;a++){var f=u[a];if(t[f]===undefined){i=this.createError(o.OBJECT_DEPENDENCY_KEY,{key:s,missing:f}).prefixWith(null,""+a).prefixWith(null,s).prefixWith(null,"dependencies");if(this.handleError(i))return i}}else if(i=this.validateAll(t,u,[],["dependencies",s],r))return i}return null},e.prototype.validateCombinations=function(t,n,r){return this.validateAllOf(t,n,r)||this.validateAnyOf(t,n,r)||this.validateOneOf(t,n,r)||this.validateNot(t,n,r)||null},e.prototype.validateAllOf=function(t,n,r){if(n.allOf===undefined)return null;var i;for(var s=0;s<n.allOf.length;s++){var o=n.allOf[s];if(i=this.validateAll(t,o,[],["allOf",s],r))return i}return null},e.prototype.validateAnyOf=function(t,n,r){if(n.anyOf===undefined)return null;var i=[],s=this.errors.length,u,a;this.trackUnknownProperties&&(u=this.unknownPropertyPaths,a=this.knownPropertyPaths);var f=!0;for(var l=0;l<n.anyOf.length;l++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=n.anyOf[l],h=this.errors.length,p=this.validateAll(t,c,[],["anyOf",l],r);if(p===null&&h===this.errors.length){this.errors=this.errors.slice(0,s);if(this.trackUnknownProperties){for(var d in this.knownPropertyPaths)a[d]=!0,delete u[d];for(var v in this.unknownPropertyPaths)a[v]||(u[v]=!0);f=!1;continue}return null}p&&i.push(p.prefixWith(null,""+l).prefixWith(null,"anyOf"))}this.trackUnknownProperties&&(this.unknownPropertyPaths=u,this.knownPropertyPaths=a);if(f)return i=i.concat(this.errors.slice(s)),this.errors=this.errors.slice(0,s),this.createError(o.ANY_OF_MISSING,{},"","/anyOf",i)},e.prototype.validateOneOf=function(t,n,r){if(n.oneOf===undefined)return null;var i=null,s=[],u=this.errors.length,a,f;this.trackUnknownProperties&&(a=this.unknownPropertyPaths,f=this.knownPropertyPaths);for(var l=0;l<n.oneOf.length;l++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=n.oneOf[l],h=this.errors.length,p=this.validateAll(t,c,[],["oneOf",l],r);if(p===null&&h===this.errors.length){if(i!==null)return this.errors=this.errors.slice(0,u),this.createError(o.ONE_OF_MULTIPLE,{index1:i,index2:l},"","/oneOf");i=l;if(this.trackUnknownProperties){for(var d in this.knownPropertyPaths)f[d]=!0,delete a[d];for(var v in this.unknownPropertyPaths)f[v]||(a[v]=!0)}}else p&&s.push(p.prefixWith(null,""+l).prefixWith(null,"oneOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=a,this.knownPropertyPaths=f),i===null?(s=s.concat(this.errors.slice(u)),this.errors=this.errors.slice(0,u),this.createError(o.ONE_OF_MISSING,{},"","/oneOf",s)):(this.errors=this.errors.slice(0,u),null)},e.prototype.validateNot=function(t,n,r){if(n.not===undefined)return null;var i=this.errors.length,s,u;this.trackUnknownProperties&&(s=this.unknownPropertyPaths,u=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var a=this.validateAll(t,n.not,null,null,r),f=this.errors.slice(i);return this.errors=this.errors.slice(0,i),this.trackUnknownProperties&&(this.unknownPropertyPaths=s,this.knownPropertyPaths=u),a===null&&f.length===0?this.createError(o.NOT_PASSED,{},"","/not"):null};var o={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},u={};for(var a in o)u[o[a]]=a;var f={INVALID_TYPE:"invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l.prototype.name="ValidationError",l.prototype.prefixWith=function(e,t){e!==null&&(e=e.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+e+this.dataPath),t!==null&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+t+this.schemaPath);if(this.subErrors!==null)for(var n=0;n<this.subErrors.length;n++)this.subErrors[n].prefixWith(e,t);return this};var h={},d=p();return d.addLanguage("en-gb",f),d.tv4=d,d}),define("schema",[],function(){var e={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{audio:{type:"object",properties:{stream_url:{type:"string"},permalink_url:{type:"string"}},required:["stream_url","permalink_url"]},track:{type:"object",properties:{artist:{type:"string"},title:{type:"string"}}},name:{type:"string"},gameobjects:{type:"array",items:[{type:"object",properties:{type:{type:"string","enum":["Tap"]},taptime:{type:"number"},x:{type:"number"},y:{type:"number"}},required:["type","taptime","x","y"]}],minItems:1,uniqueItems:!0}},required:["audio","name","gameobjects"]};return e}),define("util/levelvalidator",["jquery","underscore","backbone","tv4","schema"],function(e,t,n,r,i){var s={};return s.validate=function(e){try{if(r.validate(JSON.parse(e),i))return!0;console.info("Level validation: "+r.error.message)}catch(t){console.info("Level validation: "+t.message)}return!1},s}),define("text!templates/leveloverview.html",[],function(){return'<div class="container">\r\n    <div class="alert alert-fatal alert-danger" id="alert_invalidlevel" style="display:none;">\r\n        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>\r\n        <div id="alert_tinvalidlevel_text"><strong>Oh snap!</strong> TouchTheBeat could not parse your leveltext. You\r\n            might want to <a href="#buildlevel" class="alert-link">create a new level</a>...\r\n        </div>\r\n\r\n    </div>\r\n    <h1>Level Overview</h1>\r\n\r\n    <p>\r\n        To start a level you or someone else has created, enter the level text in the textfield below and press\r\n        "Start!".\r\n    </p>\r\n\r\n    <p>\r\n\r\n    <div class="input-group">\r\n\r\n        <input type="text" class="form-control" placeholder="Copy you level-text here..." id="leveljsoninput">\r\n      <span class="input-group-btn">\r\n        <button class="btn btn-primary" type="button" id="startlevel">Start!</button>\r\n      </span>\r\n    </div>\r\n    </p>\r\n    <hr/>\r\n    <p> You can also try one of the demo-levels below.</p>\r\n\r\n    <div id="levelcontainer" class="list-group col-md-8"></div>\r\n</div>\r\n'}),define("text!templates/levelpanel.html",[],function(){return'<h4 class="list-group-item-heading"><%= levelname %></h4>\r\n<p class="list-group-item-text">\r\n<dl class="dl-horizontal">\r\n    <dt>Author</dt>\r\n    <dd><%= author %></dd>\r\n    <dt>Track</dt>\r\n    <dd><%= track %> by <%= artist %>\r\n        <!--<a href="<%= trackurl %>"><%= track %></a> by <a href="<%= artisturl %>"><%= artist %></a>--></dd>\r\n    <dt>Duration</dt>\r\n    <dd><%= duration %></dd>\r\n</dl>\r\n</p>'}),define("views/levelpanel",["jquery","underscore","backbone","util/levelvalidator","text!templates/levelpanel.html","app"],function(e,t,n,r,i,s){var o=n.View.extend({tagName:"a",attributes:{"class":"list-group-item",href:"#"},render:function(e){var n=t.template(i,{levelname:e.name,artist:e.track.artist?e.track.artist:"Unknown",artisturl:"#",track:e.track.title?e.track.title:"Unknown",trackurl:e.audio.permalink_url,duration:"not set",author:e.author?e.author:"Unknown"});this.$el.html(n),this.level=e},events:{click:"startlevel"},startlevel:function(e){e.preventDefault(),s.startlevel(this.level)}});return o}),define("text!templates/play.html",[],function(){return'<div id="playdiv" class="svgcontainer">\r\n    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%" viewBox="0 0 1600 1200" id="svg">\r\n    </svg>\r\n</div>\r\n\r\n'}),define("util/SoundcloudLoader",["jquery"],function(e){var t={loadStream:function(t,n,r){console.log("resolving: "+t),e.get("//dev.coloreddrums.de/ttb/server/gettrack.php",{p:t}).done(function(t){try{t.errors&&r("There was an error loading the track from SoundCloud. Please try again later or contact me if the error still occurs."),t.streamable?(console.log("resolved: "+t.stream_url),n(t)):r("Sorry. The track you entered is not streamable. Please select a different one.")}catch(i){console.error(i),r("Make sure the URL has the correct format: https://soundcloud.com/user/title-of-the-track")}})},getStreamUrl:function(e){return e+"?client_id="+"1dfc22b8b6e9ae1fd500cf90f9065607"}};return t}),define("text!templates/applicationwithmenu.html",[],function(){return'<div class="navbar navbar-inverse" id="menu">\r\n</div>\r\n<div id="abovecontent"></div>\r\n<div id="content"></div>\r\n<hr>\r\n<div class="container">\r\n    <footer>\r\n        <a class="pull-right" href="http://soundcloud.com" target="_blank">\r\n            <img src="img/powered_by_black.png"/>\r\n        </a>\r\n        </p>\r\n    </footer>\r\n</div>'}),define("views/applicationwithmenu",["jquery","underscore","backbone","text!templates/applicationwithmenu.html","views/menu"],function(e,t,n,r,i){var s=n.View.extend({el:"body",render:function(){var e=t.template(r,{});this.$el.html(e),this.menu=new i,this.menu.render()},getMenu:function(){return this.menu}});return s}),define("gameclasses/Surface",["jquery","underscore","backbone","snap"],function(e,t,n,r){var i=function(e){this.options=e,this.snap=new r("#svg"),this.r=this.snap.rect(0,0,"100%","100%",0),this.r.attr({fill:this.options.bgcolor?this.options.bgcolor:"#000000"})};return i.prototype={width:1600,height:1200,showLoadingIndicator:function(){this.loadingindicator=this.snap.text(this.width/2,this.height/2,"Loading..."),this.loadingindicator.attr({fill:"#FFFFFF","font-size":"5em",textAnchor:"middle",filter:this.snap.filter(r.filter.shadow(0,2,3))})},getSnap:function(){return this.snap},getRootRect:function(){return this.r},hideLoadingIndicator:function(){console.log("hiding loading indicator"),this.loadingindicator&&this.loadingindicator.remove()},requestStartFromUser:function(t){var n=this.snap.text(this.width/2,this.height/2,"Tap here to start!");n.attr({fill:"#FFFFFF","font-size":"5em",textAnchor:"middle",filter:this.snap.filter(r.filter.shadow(0,2,3)),id:"startactionbutton"}),this.startaction=n,e("#startactionbutton").click(function(){n.untouchend(),n.remove(),t()})}},i}),define("gameclasses/TapObject",["jquery","underscore","backbone","snap","util/analytics"],function(e,t,n,r,i){var s=function(e,t,n,r){this.game=e,this.x=n,this.y=r,this.timestamp=t};return s.prototype={startborder:-0.5,endborder:0,radius:120,borderradius:20,removeuntil:.5,removefrom:.4,startshow:-0.8,endshow:0,visual_type:"circle",color_plain_fill:"#FFFFFF",color_plain_border:"#EEEEEE",color_tapped_fill:"#33CC33",color_tapped_border:"#FFFF66",color_missed_fill:"#CC0000",color_missed_border:"#CC0000",tapdelta:NaN,snapobject:null,renderloop_enabled:!0,logic_enabled:!0,time_render:NaN,time_logic:NaN,tapped:!1,tapdiff:NaN,max_tapdiff:.2,debugtime:NaN,setSnapAttr:function(e){this.snapobject==null&&this.createVisualElement(),this.snapobject!=null&&this.snapobject.attr(e)},createVisualElement:function(){switch(this.visual_type){case"circle":this.snapobject=this.game.surface.getSnap().circle(this.x,this.y,this.radius);break;default:console.error("unknown tapobject type: "+this.visual_type)}this.snapobject.attr({fill:this.color_plain_fill,stroke:this.color_plain_border,strokeWidth:this.borderradius,opacity:0}),this.snapobject.touchend(this.handleTap.bind(this)),this.snapobject.click(this.handleTap.bind(this))},markMissed:function(){this.setSnapAttr({fill:this.color_missed_fill}),this.logic_enabled=!1,this.time_logic<this.max_tapdiff&&(console.log("TapObject was missed (too early) at "+Math.abs(Math.floor(this.time_logic*100))),i.trackAction("game","TapObject","missed (too early)",Math.abs(Math.abs(Math.floor(this.time_logic*100)))));var e=Math.abs(Math.floor(this.tapdiff*1e3))},markHit:function(){this.timestamp==this.debugtime&&console.log("hit"),this.setSnapAttr({fill:this.color_tapped_fill}),this.tapdiff=this.time_logic,this.logic_enabled=!1,i.trackAction("game","TapObject","hit (too "+(this.tapdiff<0?"early":"late")+")",Math.abs(Math.floor(this.tapdiff*100))),console.log("TapObject was hit too "+(this.tapdiff<0?"early":"late")+" at "+Math.abs(Math.floor(this.tapdiff*100)))},handleTap:function(){this.timestamp==this.debugtime&&console.info("allowed tap: "+this.logic_enabled),this.tapped||(this.tapped=!0,this.logic_enabled?Math.abs(this.getTimeDiff())<=this.max_tapdiff?this.markHit():this.markMissed():(console.log("TapObject was missed (too late) at "+Math.abs(Math.floor(this.time_logic*100))),i.trackAction("game","TapObject","missed (too late)",Math.abs(Math.floor(this.time_logic*100)))))},markUpcoming:function(e){this.timestamp==this.debugtime&&console.log("mark upcoming at "+this.time_render+" with "+e+"%"),this.setSnapAttr({strokeWidth:this.borderradius*e})},setOpacity:function(e){this.setSnapAttr({opacity:e})},update:function(){this.logic_enabled&&(this.time_logic=this.getTimeDiff(),this.timestamp==this.debugtime&&console.log("logic update at "+this.time_logic),this.time_logic>=this.max_tapdiff&&this.markMissed())},render:function(){this.renderloop_enabled&&(this.time_render=this.getTimeDiff(),this.time_render>=this.startborder&&this.time_render<this.endborder&&(this.timestamp==this.debugtime&&console.log("upcoming: "+this.getPercentage(this.startborder,this.endborder)),this.markUpcoming(this.getPercentage(this.startborder,this.endborder))),this.time_render>=this.startshow&&this.time_render<this.endshow&&(this.snapobject==null&&this.createVisualElement(),this.timestamp==this.debugtime&&console.log("fading in: 1"-this.getPercentage(this.startshow,this.endshow)),this.setOpacity(1-this.getPercentage(this.startshow,this.endshow))),this.time_render>=this.removefrom&&this.time_render<this.removeuntil&&this.setOpacity(1-this.getPercentage(this.removefrom,this.removeuntil)),this.time_render>=this.removeuntil&&(this.renderloop_enabled=!1,this.snapobject!=null&&this.snapobject.remove(),this.tapped||i.trackAction("game","TapObject","was not tapped"),this.timestamp==this.debugtime&&console.log("removed from dom: "+this.timestamp+" at "+this.time_render+" ("+(this.time_render-this.removeuntil)+")")))},getTimeDiff:function(){return this.game.getTime()-this.timestamp},getPercentage:function(e,t){var n=this.time_render/(t-e);return Math.abs(n)},getHighScore:function(){if(isNaN(this.tapdiff))return 0;var e=Math.abs(this.tapdiff)-.05;return e<=0?1:1-e/this.max_tapdiff}},s}),define("gameclasses/Game",["jquery","underscore","backbone","gameclasses/Surface","gameclasses/TapObject"],function(e,t,n,r,s){var o=function(e){this.playview=e,this.level=this.playview.level,this.gameobjects=[],this.setup(),this.surface=new r({bgcolor:"#000000"}),this.surface.showLoadingIndicator()};return o.prototype={width:1600,height:1200,taptimeframe:10,playview:null,setup:function(){console.log("setting up game");for(i=0;i<this.level.gameobjects.length;i++){var e=this.level.gameobjects[i];switch(e.type){case"Tap":this.gameobjects.push(new s(this,e.taptime,e.x,e.y));break;default:console.error("undefined gameobject detected")}}},getRandomInteger:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getTime:function(){return this.playview.getTimeDelta.bind(this.playview)()},update:function(){if(!this.stopped)for(var e=0;e<this.gameobjects.length;e++)this.gameobjects[e].update(this.getTime())},updateView:function(e){if(!this.stopped){for(var t=0;t<this.gameobjects.length;t++)this.gameobjects[t].render(e);requestAnimationFrame(this.updateView.bind(this))}},start:function(){this.updateinterval=setInterval(this.update.bind(this),1e3/60),this.updateView(this.getTime())},stop:function(){clearInterval(this.updateinterval),this.stopped=!0},calculateHighScore:function(){var e=0;for(var t=0;t<this.gameobjects.length;t++)e+=this.gameobjects[t].getHighScore();var n=e/this.gameobjects.length;return(n*100).toFixed(1)+"%"}},o}),define("views/audio",["jquery","underscore","backbone","app","util/analytics"],function(e,t,n,r,i){var s=n.View.extend({el:"#player",onClose:function(){this.active=!1,console.log("closing audio"),this.request&&(this.request.abort(),this.request=null);try{this.source&&(this.source.disconnect(),this.source.stop(),this.source=null)}catch(e){}},onended:function(){console.info("The audio has stopped"),this.notified_ended||(this.callback_ended(),this.notified_ended=!0)},render:function(e,t){this.canplaythrough=!1,this.notified_error=!1,this.notified_success=!1,this.notified_readytoplay=!1,this.notified_ended=!1,this.active=!0,this.inittime=null,this.playasap=t;try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.context=new AudioContext;var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer";var r=function(e){console.log("onload"),this.active&&this.context.decodeAudioData(n.response,this.initsound.bind(this),this.callback_error)}.bind(this);n.onload=r,console.log("loading audio"),this.request=n,this.request.send()}catch(i){this.callback_error("Web Audio API is not supported in this browser")}},initsound:function(e){console.log("init sound");if(!this.active)return;var t=this.context.createBufferSource();t.buffer=e,t.connect(this.context.destination),t.onended=this.onended.bind(this),this.source=t,this.callback_readytoplay()},start:function(){this.source.start(0),this.inittime=this.context.currentTime,this.callback_started()},setCallbacks:function(e,t,n,r){this.callback_ended=t,this.callback_started=e,this.callback_readytoplay=n,this.callback_error=r},getCurrentTime:function(){return this.context.currentTime-this.inittime},getPercentage:function(){return this.getCurrentTime()/this.getDuration()},getDuration:function(){return this.source.buffer.duration}});return s}),define("util/scripts",["jquery"],function(e){return function(){var e=0,t=["ms","moz","webkit","o"],n=!!window.performance&&!!window.performance.now;for(var r=0,i=t.length;r<i&&!window.requestAnimationFrame;r+=1)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)});if(!n){var s=window.requestAnimationFrame,o=+(new Date);window.requestAnimationFrame=function(e,t){var n=function(t){var n=t<1e12?t:t-o;return e(n)};s(n,t)}}}(),e(document).unbind("keydown").bind("keydown",function(e){var t=!1;if(e.keyCode===8){var n=e.srcElement||e.target;n.tagName.toUpperCase()==="INPUT"&&(n.type.toUpperCase()==="TEXT"||n.type.toUpperCase()==="PASSWORD"||n.type.toUpperCase()==="FILE"||n.type.toUpperCase()==="EMAIL")||n.tagName.toUpperCase()==="TEXTAREA"?t=n.readOnly||n.disabled:t=!0}t&&e.preventDefault()}),function(){if(window.performance&&window.performance.now)return;window.performance||(window.performance={});var e=["webkitNow","msNow","mozNow"];for(var t=0;t<e.length;t++)if(window.performance[e[t]]){window.performance.now=window.performance[e[t]];return}if(Date.now){window.performance.now=function(){return Date.now()};return}window.performance.now=function(){return+(new Date)}}(),{}}),define("views/PlayView",["jquery","underscore","backbone","text!templates/play.html","app","util/SoundcloudLoader","views/applicationwithmenu","gameclasses/Game","util/analytics","views/audio","util/scripts"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({el:"#body",onClose:function(){console.log("onclose event fired"),this.startobj!=null&&(console.log("closing game"),a.trackAction("game","closing game"),this.game!=null&&this.game.stop(),this.startobj=null,this.result=null),this.audiocontroller&&(this.audiocontroller.onClose(),this.audiocontroller.dispose()),this.game=null,this.player&&this.player.off()},stopGame:function(){a.trackAction("game","ending game"),console.info("Now ending game."),this.game.stop(),e("#svg").fadeTo(1500,0,this.exitview.bind(this)),this.result={},this.result.highscore=this.game.calculateHighScore(),this.result.level=this.level,this.audiocontroller.dispose()},render:function(e){n.history.navigate("playlevel",!1),this.onClose(),this.level=e;var i=t.template(r,{});this.$el.html(i),this.audiocontroller=new f,this.audiocontroller.setCallbacks(this.onAudioStarted.bind(this),this.stopGame.bind(this),this.onAudioReady.bind(this),this.onAudioError.bind(this)),this.audiocontroller.render(s.getStreamUrl(this.level.audio.stream_url),!0),this.game=new u(this)},onAudioReady:function(){this.game.surface.hideLoadingIndicator(),this.game.surface.requestStartFromUser(this.audiocontroller.start.bind(this.audiocontroller))},onAudioStarted:function(){this.game.start()},onAudioError:function(){console.error("Audio error!!!!!"),console.log(parameters),this.audiocontroller.onClose(),this.audiocontroller.dispose()},getTimeDelta:function(){return this.audiocontroller.getCurrentTime()},exitview:function(){a.trackAction("game","ending regularly","highscore:"+this.result.highscore),i.setContent(i.router.highscoreview,this.result)}});return l}),define("levelcontainer",[],function(){return levelcontainer=[{audio:{stream_url:"http://api.soundcloud.com/tracks/57984848/stream",permalink_url:"http://soundcloud.com/dearreadermusic/03-great-white-bear"},gameobjects:[{type:"Tap",x:130,y:650,taptime:7.9786666666667},{type:"Tap",x:450,y:350,taptime:9.8986666666667},{type:"Tap",x:750,y:950,taptime:10.837333333333},{type:"Tap",x:930,y:650,taptime:11.861333333333},{type:"Tap",x:1150,y:650,taptime:13.269333333333},{type:"Tap",x:1420,y:650,taptime:13.525333333333},{type:"Tap",x:130,y:650,taptime:15.658666666667},{type:"Tap",x:450,y:350,taptime:17.621333333333},{type:"Tap",x:750,y:950,taptime:18.602666666667},{type:"Tap",x:930,y:650,taptime:19.541333333333},{type:"Tap",x:1150,y:650,taptime:20.949333333333},{type:"Tap",x:1420,y:650,taptime:21.248},{type:"Tap",x:50,y:150,taptime:23.338666666667},{type:"Tap",x:1500,y:150,taptime:23.850666666667},{type:"Tap",x:50,y:450,taptime:24.413333333333},{type:"Tap",x:1500,y:450,taptime:24.874666666667},{type:"Tap",x:50,y:750,taptime:25.344},{type:"Tap",x:1500,y:750,taptime:25.856},{type:"Tap",x:50,y:1050,taptime:26.368},{type:"Tap",x:330,y:1050,taptime:26.88},{type:"Tap",x:550,y:1050,taptime:27.093333333333},{type:"Tap",x:550,y:750,taptime:27.306666666667},{type:"Tap",x:550,y:450,taptime:27.776},{type:"Tap",x:550,y:150,taptime:28.245333333333},{type:"Tap",x:750,y:150,taptime:28.8},{type:"Tap",x:970,y:150,taptime:29.013333333333},{type:"Tap",x:970,y:450,taptime:29.269333333333},{type:"Tap",x:970,y:730,taptime:29.696},{type:"Tap",x:970,y:1050,taptime:30.165333333333},{type:"Tap",x:50,y:150,taptime:31.146666666667},{type:"Tap",x:1500,y:150,taptime:31.573333333333},{type:"Tap",x:50,y:450,taptime:32.085333333333},{type:"Tap",x:1500,y:450,taptime:32.554666666667},{type:"Tap",x:50,y:750,taptime:33.024},{type:"Tap",x:1500,y:750,taptime:33.493333333333},{type:"Tap",x:50,y:1050,taptime:34.005333333333},{type:"Tap",x:330,y:1050,taptime:34.517333333333},{type:"Tap",x:550,y:1050,taptime:34.730666666667},{type:"Tap",x:550,y:750,taptime:34.986666666667},{type:"Tap",x:550,y:450,taptime:35.456},{type:"Tap",x:550,y:150,taptime:35.925333333333},{type:"Tap",x:750,y:150,taptime:36.394666666667},{type:"Tap",x:970,y:150,taptime:36.650666666667},{type:"Tap",x:970,y:450,taptime:36.906666666667},{type:"Tap",x:970,y:750,taptime:37.376},{type:"Tap",x:970,y:1050,taptime:37.845333333333},{type:"Tap",x:50,y:150,taptime:38.826666666667},{type:"Tap",x:1500,y:150,taptime:39.253333333333},{type:"Tap",x:50,y:450,taptime:39.765333333333},{type:"Tap",x:1500,y:450,taptime:40.277333333333},{type:"Tap",x:50,y:750,taptime:40.789333333333},{type:"Tap",x:1500,y:750,taptime:41.258666666667},{type:"Tap",x:50,y:1050,taptime:41.770666666667},{type:"Tap",x:330,y:1050,taptime:42.24},{type:"Tap",x:550,y:1050,taptime:42.453333333333},{type:"Tap",x:550,y:750,taptime:42.752},{type:"Tap",x:550,y:450,taptime:43.221333333333},{type:"Tap",x:550,y:150,taptime:43.690666666667},{type:"Tap",x:750,y:150,taptime:44.16},{type:"Tap",x:970,y:150,taptime:44.373333333333},{type:"Tap",x:970,y:450,taptime:44.629333333333},{type:"Tap",x:970,y:750,taptime:45.098666666667},{type:"Tap",x:970,y:1050,taptime:45.568},{type:"Tap",x:400,y:550,taptime:46.592},{type:"Tap",x:800,y:300,taptime:48.554666666667},{type:"Tap",x:800,y:800,taptime:50.432},{type:"Tap",x:1200,y:550,taptime:52.352},{type:"Tap",x:400,y:550,taptime:54.314666666667},{type:"Tap",x:800,y:300,taptime:56.234666666667},{type:"Tap",x:1e3,y:1050,taptime:57.216},{type:"Tap",x:1400,y:1050,taptime:57.685333333333},{type:"Tap",x:800,y:800,taptime:58.197333333333},{type:"Tap",x:1200,y:550,taptime:60.117333333333},{type:"Tap",x:130,y:650,taptime:62.037333333333},{type:"Tap",x:450,y:350,taptime:64},{type:"Tap",x:750,y:950,taptime:64.896},{type:"Tap",x:930,y:650,taptime:65.877333333333},{type:"Tap",x:1150,y:650,taptime:67.285333333333},{type:"Tap",x:1420,y:650,taptime:67.541333333333},{type:"Tap",x:130,y:650,taptime:69.674666666667},{type:"Tap",x:450,y:350,taptime:71.637333333333},{type:"Tap",x:750,y:950,taptime:72.533333333333},{type:"Tap",x:930,y:650,taptime:73.557333333333},{type:"Tap",x:1150,y:650,taptime:75.008},{type:"Tap",x:1420,y:650,taptime:75.221333333333},{type:"Tap",x:300,y:850,taptime:77.482666666667},{type:"Tap",x:1200,y:850,taptime:78.890666666667},{type:"Tap",x:750,y:350,taptime:80.384},{type:"Tap",x:300,y:850,taptime:81.365333333333},{type:"Tap",x:1200,y:850,taptime:82.816},{type:"Tap",x:750,y:350,taptime:84.224},{type:"Tap",x:300,y:850,taptime:85.162666666667},{type:"Tap",x:1200,y:850,taptime:86.613333333333},{type:"Tap",x:750,y:350,taptime:88.064},{type:"Tap",x:300,y:850,taptime:89.045333333333},{type:"Tap",x:1200,y:850,taptime:90.496},{type:"Tap",x:750,y:350,taptime:91.946666666667},{type:"Tap",x:300,y:850,taptime:92.928},{type:"Tap",x:750,y:850,taptime:93.653333333333},{type:"Tap",x:1200,y:850,taptime:94.378666666667},{type:"Tap",x:975,y:600,taptime:95.146666666667},{type:"Tap",x:750,y:350,taptime:95.829333333333},{type:"Tap",x:300,y:850,taptime:96.768},{type:"Tap",x:750,y:850,taptime:97.493333333333},{type:"Tap",x:1200,y:850,taptime:98.218666666667},{type:"Tap",x:975,y:600,taptime:98.944},{type:"Tap",x:750,y:350,taptime:99.669333333333},{type:"Tap",x:500,y:600,taptime:100.65066666667},{type:"Tap",x:200,y:600,taptime:101.54666666667},{type:"Tap",x:800,y:500,taptime:102.528},{type:"Tap",x:800,y:200,taptime:103.50933333333},{type:"Tap",x:800,y:700,taptime:104.40533333333},{type:"Tap",x:800,y:1e3,taptime:105.38666666667},{type:"Tap",x:1100,y:600,taptime:106.28266666667},{type:"Tap",x:1400,y:600,taptime:107.30666666667},{type:"Tap",x:500,y:600,taptime:108.24533333333},{type:"Tap",x:200,y:600,taptime:109.184},{type:"Tap",x:800,y:500,taptime:110.208},{type:"Tap",x:800,y:200,taptime:111.232},{type:"Tap",x:800,y:700,taptime:112.128},{type:"Tap",x:800,y:1e3,taptime:113.10933333333},{type:"Tap",x:1400,y:1050,taptime:114.09066666667},{type:"Tap",x:150,y:1050,taptime:114.09066666667},{type:"Tap",x:150,y:750,taptime:115.072},{type:"Tap",x:1400,y:750,taptime:115.072},{type:"Tap",x:1400,y:450,taptime:116.096},{type:"Tap",x:150,y:450,taptime:116.096},{type:"Tap",x:1400,y:150,taptime:117.034},{type:"Tap",x:150,y:150,taptime:117.034},{type:"Tap",x:1400,y:1050,taptime:118.05866666667},{type:"Tap",x:150,y:1050,taptime:118.05866666667},{type:"Tap",x:150,y:750,taptime:118.99733333333},{type:"Tap",x:1400,y:750,taptime:118.99733333333},{type:"Tap",x:1400,y:450,taptime:119.936},{type:"Tap",x:150,y:450,taptime:119.936},{type:"Tap",x:1400,y:150,taptime:120.87466666667},{type:"Tap",x:150,y:150,taptime:120.87466666667},{type:"Tap",x:1400,y:1050,taptime:121.856},{type:"Tap",x:150,y:1050,taptime:121.856},{type:"Tap",x:150,y:750,taptime:122.83733333333},{type:"Tap",x:1400,y:750,taptime:122.83733333333},{type:"Tap",x:1400,y:450,taptime:123.776},{type:"Tap",x:150,y:450,taptime:123.776},{type:"Tap",x:1400,y:150,taptime:124.75},{type:"Tap",x:150,y:150,taptime:124.75},{type:"Tap",x:150,y:1050,taptime:125.73866666667},{type:"Tap",x:1400,y:1050,taptime:125.73866666667},{type:"Tap",x:1400,y:750,taptime:126.67733333333},{type:"Tap",x:150,y:750,taptime:126.67733333333},{type:"Tap",x:1400,y:450,taptime:127.65866666667},{type:"Tap",x:150,y:450,taptime:127.65866666667},{type:"Tap",x:1400,y:150,taptime:128.64},{type:"Tap",x:150,y:150,taptime:128.64},{type:"Tap",x:800,y:500,taptime:129.62133333333},{type:"Tap",x:650,y:150,taptime:133.41866666667},{type:"Tap",x:900,y:150,taptime:133.41866666667},{type:"Tap",x:350,y:150,taptime:134.4},{type:"Tap",x:1200,y:150,taptime:134.4},{type:"Tap",x:650,y:450,taptime:135.424},{type:"Tap",x:900,y:450,taptime:135.424},{type:"Tap",x:350,y:450,taptime:136.36266666667},{type:"Tap",x:1200,y:450,taptime:136.36266666667},{type:"Tap",x:650,y:750,taptime:137.30133333333},{type:"Tap",x:900,y:750,taptime:137.30133333333},{type:"Tap",x:350,y:750,taptime:138.28266666667},{type:"Tap",x:1200,y:750,taptime:138.28266666667},{type:"Tap",x:650,y:1050,taptime:139.17},{type:"Tap",x:900,y:1050,taptime:139.17},{type:"Tap",x:350,y:1050,taptime:140.20266666667},{type:"Tap",x:1200,y:1050,taptime:140.20266666667},{type:"Tap",x:650,y:150,taptime:141.14133333333},{type:"Tap",x:900,y:150,taptime:141.14133333333},{type:"Tap",x:350,y:150,taptime:142.16533333333},{type:"Tap",x:1200,y:150,taptime:142.16533333333},{type:"Tap",x:650,y:450,taptime:143.104},{type:"Tap",x:900,y:450,taptime:143.104},{type:"Tap",x:350,y:450,taptime:144.04266666667},{type:"Tap",x:1200,y:450,taptime:144.04266666667},{type:"Tap",x:650,y:750,taptime:144.98133333333},{type:"Tap",x:900,y:750,taptime:144.98133333333},{type:"Tap",x:350,y:750,taptime:145.92},{type:"Tap",x:1200,y:750,taptime:145.92},{type:"Tap",x:650,y:1050,taptime:146.816},{type:"Tap",x:900,y:1050,taptime:146.816},{type:"Tap",x:350,y:1050,taptime:147.75466666667},{type:"Tap",x:1200,y:1050,taptime:147.75466666667},{type:"Tap",x:150,y:700,taptime:150.86933333333},{type:"Tap",x:650,y:700,taptime:151.76533333333},{type:"Tap",x:920,y:700,taptime:151.89333333333},{type:"Tap",x:1400,y:700,taptime:152.27733333333},{type:"Tap",x:150,y:700,taptime:152.74666666667},{type:"Tap",x:650,y:700,taptime:153.68533333333},{type:"Tap",x:920,y:700,taptime:153.81333333333},{type:"Tap",x:1400,y:700,taptime:154.19733333333},{type:"Tap",x:150,y:700,taptime:154.70933333333},{type:"Tap",x:650,y:700,taptime:155.60533333333},{type:"Tap",x:920,y:700,taptime:155.73333333333},{type:"Tap",x:1400,y:700,taptime:156.11733333333},{type:"Tap",x:150,y:700,taptime:156.672},{type:"Tap",x:650,y:700,taptime:157.52533333333},{type:"Tap",x:920,y:700,taptime:157.696},{type:"Tap",x:1400,y:700,taptime:158.08},{type:"Tap",x:150,y:700,taptime:158.54933333333},{type:"Tap",x:650,y:700,taptime:159.44533333333},{type:"Tap",x:920,y:700,taptime:159.57333333333},{type:"Tap",x:1400,y:700,taptime:159.95733333333},{type:"Tap",x:150,y:700,taptime:160.46933333333},{type:"Tap",x:650,y:700,taptime:161.408},{type:"Tap",x:920,y:700,taptime:161.536},{type:"Tap",x:1400,y:700,taptime:161.92},{type:"Tap",x:150,y:700,taptime:162.38933333333},{type:"Tap",x:500,y:700,taptime:163.2},{type:"Tap",x:770,y:700,taptime:163.328},{type:"Tap",x:1040,y:700,taptime:163.584},{type:"Tap",x:1400,y:700,taptime:163.79733333333},{type:"Tap",x:400,y:300,taptime:164.26666666667},{type:"Tap",x:100,y:900,taptime:166.22933333333},{type:"Tap",x:400,y:900,taptime:167.168},{type:"Tap",x:700,y:900,taptime:168.14933333333},{type:"Tap",x:1e3,y:900,taptime:169.13066666667},{type:"Tap",x:1300,y:900,taptime:170.112},{type:"Tap",x:1600,y:900,taptime:171.09333333333},{type:"Tap",x:400,y:300,taptime:171.98933333333},{type:"Tap",x:800,y:300,taptime:172.50133333333},{type:"Tap",x:100,y:900,taptime:173.952},{type:"Tap",x:400,y:900,taptime:174.93333333333},{type:"Tap",x:700,y:900,taptime:175.872},{type:"Tap",x:1e3,y:900,taptime:176.85333333333},{type:"Tap",x:1300,y:900,taptime:177.792},{type:"Tap",x:1600,y:900,taptime:178.77333333333},{type:"Tap",x:400,y:300,taptime:179.712},{type:"Tap",x:800,y:300,taptime:180.13866666667},{type:"Tap",x:1200,y:300,taptime:180.69333333333},{type:"Tap",x:100,y:900,taptime:181.71733333333},{type:"Tap",x:400,y:900,taptime:182.69866666667},{type:"Tap",x:700,y:900,taptime:183.59466666667},{type:"Tap",x:1e3,y:900,taptime:184.53333333333},{type:"Tap",x:1300,y:900,taptime:185.51466666667},{type:"Tap",x:1600,y:900,taptime:186.5},{type:"Tap",x:400,y:300,taptime:187.43466666667},{type:"Tap",x:800,y:300,taptime:187.904},{type:"Tap",x:1200,y:300,taptime:188.45866666667},{type:"Tap",x:100,y:900,taptime:189.44},{type:"Tap",x:400,y:900,taptime:190.37866666667},{type:"Tap",x:700,y:900,taptime:191.36},{type:"Tap",x:1e3,y:900,taptime:192.256},{type:"Tap",x:1300,y:900,taptime:193.23733333333},{type:"Tap",x:1600,y:900,taptime:194.21866666667},{type:"Tap",x:400,y:300,taptime:195.15733333333},{type:"Tap",x:800,y:300,taptime:195.584},{type:"Tap",x:1200,y:300,taptime:196.13866666667},{type:"Tap",x:100,y:900,taptime:197.12},{type:"Tap",x:400,y:900,taptime:198.10133333333},{type:"Tap",x:700,y:900,taptime:199.04},{type:"Tap",x:1e3,y:900,taptime:199.97866666667},{type:"Tap",x:1300,y:900,taptime:201.00266666667},{type:"Tap",x:1600,y:900,taptime:201.984},{type:"Tap",x:400,y:300,taptime:202.88},{type:"Tap",x:800,y:300,taptime:203.34933333333},{type:"Tap",x:1200,y:300,taptime:203.81866666667},{type:"Tap",x:100,y:900,taptime:204.84266666667},{type:"Tap",x:400,y:900,taptime:205.824},{type:"Tap",x:700,y:900,taptime:206.76266666667},{type:"Tap",x:1e3,y:900,taptime:207.70133333333},{type:"Tap",x:1400,y:1050,taptime:208.72533333333},{type:"Tap",x:150,y:1050,taptime:208.72533333333},{type:"Tap",x:1400,y:750,taptime:209.70666666667},{type:"Tap",x:150,y:750,taptime:209.70666666667},{type:"Tap",x:1400,y:450,taptime:210.688},{type:"Tap",x:150,y:450,taptime:210.688},{type:"Tap",x:1400,y:150,taptime:211.62},{type:"Tap",x:150,y:150,taptime:211.62},{type:"Tap",x:1400,y:1050,taptime:212.56533333333},{type:"Tap",x:150,y:1050,taptime:212.56533333333},{type:"Tap",x:150,y:750,taptime:213.55},{type:"Tap",x:1400,y:750,taptime:213.55},{type:"Tap",x:1400,y:450,taptime:214.528},{type:"Tap",x:150,y:450,taptime:214.528},{type:"Tap",x:1400,y:150,taptime:215.55},{type:"Tap",x:150,y:150,taptime:215.55},{type:"Tap",x:150,y:1050,taptime:216.448},{type:"Tap",x:1400,y:1050,taptime:216.448},{type:"Tap",x:1400,y:750,taptime:217.38666666667},{type:"Tap",x:150,y:750,taptime:217.38666666667},{type:"Tap",x:1400,y:450,taptime:218.368},{type:"Tap",x:150,y:450,taptime:218.368},{type:"Tap",x:1400,y:150,taptime:219.30666666667},{type:"Tap",x:150,y:150,taptime:219.30666666667},{type:"Tap",x:1400,y:1050,taptime:220.288},{type:"Tap",x:150,y:1050,taptime:220.288},{type:"Tap",x:1400,y:750,taptime:221.269},{type:"Tap",x:150,y:750,taptime:221.269},{type:"Tap",x:1400,y:450,taptime:222.208},{type:"Tap",x:150,y:450,taptime:222.208},{type:"Tap",x:1400,y:150,taptime:223.189},{type:"Tap",x:150,y:150,taptime:223.189},{type:"Tap",x:150,y:1050,taptime:224.128},{type:"Tap",x:1400,y:1050,taptime:224.128},{type:"Tap",x:1400,y:750,taptime:225.10933333333},{type:"Tap",x:150,y:750,taptime:225.10933333333},{type:"Tap",x:1400,y:450,taptime:226.048},{type:"Tap",x:150,y:450,taptime:226.048},{type:"Tap",x:150,y:150,taptime:227.02933333333},{type:"Tap",x:1400,y:150,taptime:227.02933333333},{type:"Tap",x:130,y:650,taptime:228.05333333333},{type:"Tap",x:450,y:350,taptime:229.97333333333},{type:"Tap",x:750,y:950,taptime:230.912},{type:"Tap",x:930,y:650,taptime:231.85066666667},{type:"Tap",x:1150,y:650,taptime:233.30133333333},{type:"Tap",x:1420,y:650,taptime:233.55733333333},{type:"Tap",x:130,y:650,taptime:235.73333333333},{type:"Tap",x:450,y:350,taptime:237.65333333333},{type:"Tap",x:750,y:950,taptime:238.592},{type:"Tap",x:930,y:650,taptime:239.53066666667},{type:"Tap",x:1150,y:650,taptime:240.98133333333},{type:"Tap",x:1420,y:650,taptime:241.28}],name:"Demolevel 1",author:"LiaLinnÃ©a",track:{title:"Great White Bear",artist:"Dear Reader"}},{audio:{stream_url:"http://api.soundcloud.com/tracks/129873688/stream",permalink_url:"http://soundcloud.com/momomoyouth/dont-wanna-dance-90clip"},gameobjects:[{type:"Tap",x:964,y:625,taptime:8.448},{type:"Tap",x:353,y:651,taptime:7.637333333333332},{type:"Tap",x:750,y:661,taptime:7.978666666666667},{type:"Tap",x:1297,y:697,taptime:8.319999999999999},{type:"Tap",x:831,y:186,taptime:9.045333333333334},{type:"Tap",x:362,y:677,taptime:9.557333333333334},{type:"Tap",x:776,y:694,taptime:9.898666666666665},{type:"Tap",x:1326,y:720,taptime:10.24},{type:"Tap",x:748,y:237,taptime:10.922666666666666},{type:"Tap",x:297,y:680,taptime:11.392000000000001},{type:"Tap",x:803,y:679,taptime:11.690666666666667},{type:"Tap",x:1232,y:697,taptime:12.031999999999998},{type:"Tap",x:710,y:212,taptime:12.714666666666668},{type:"Tap",x:315,y:701,taptime:13.226666666666665},{type:"Tap",x:800,y:687,taptime:13.568},{type:"Tap",x:1268,y:673,taptime:13.909333333333334},{type:"Tap",x:770,y:213,taptime:14.634666666666666},{type:"Tap",x:340,y:669,taptime:15.061333333333332},{type:"Tap",x:778,y:657,taptime:15.402666666666667},{type:"Tap",x:1314,y:662,taptime:15.786666666666667},{type:"Tap",x:694,y:201,taptime:16.384},{type:"Tap",x:312,y:666,taptime:16.896},{type:"Tap",x:763,y:675,taptime:17.237333333333332},{type:"Tap",x:1216,y:640,taptime:17.578666666666663},{type:"Tap",x:757,y:193,taptime:18.261333333333333},{type:"Tap",x:341,y:645,taptime:18.730666666666664},{type:"Tap",x:781,y:613,taptime:19.072000000000003},{type:"Tap",x:1247,y:606,taptime:19.370666666666665},{type:"Tap",x:759,y:186,taptime:20.138666666666666},{type:"Tap",x:347,y:667,taptime:20.693333333333335},{type:"Tap",x:786,y:694,taptime:20.991999999999997},{type:"Tap",x:1297,y:661,taptime:21.290666666666667},{type:"Tap",x:391,y:621,taptime:22.442666666666668},{type:"Tap",x:762,y:621,taptime:22.784},{type:"Tap",x:1281,y:628,taptime:23.125333333333337},{type:"Tap",x:794,y:1011,taptime:23.381333333333338},{type:"Tap",x:724,y:143,taptime:23.85066666666667},{type:"Tap",x:277,y:565,taptime:24.27733333333334},{type:"Tap",x:768,y:605,taptime:24.576},{type:"Tap",x:1232,y:571,taptime:24.96},{type:"Tap",x:784,y:970,taptime:25.216},{type:"Tap",x:760,y:147,taptime:25.685333333333332},{type:"Tap",x:337,y:538,taptime:26.15466666666667},{type:"Tap",x:779,y:611,taptime:26.453333333333333},{type:"Tap",x:1218,y:588,taptime:26.837333333333333},{type:"Tap",x:846,y:994,taptime:27.093333333333334},{type:"Tap",x:713,y:233,taptime:27.562666666666665},{type:"Tap",x:347,y:592,taptime:27.989333333333335},{type:"Tap",x:803,y:604,taptime:28.288000000000004},{type:"Tap",x:1291,y:590,taptime:28.672000000000004},{type:"Tap",x:891,y:1023,taptime:28.928000000000004},{type:"Tap",x:800,y:189,taptime:29.354666666666667},{type:"Tap",x:343,y:643,taptime:29.866666666666667},{type:"Tap",x:774,y:623,taptime:30.165333333333336},{type:"Tap",x:1293,y:610,taptime:30.506666666666668},{type:"Tap",x:894,y:1036,taptime:30.762666666666668},{type:"Tap",x:890,y:240,taptime:31.40266666666667},{type:"Tap",x:338,y:572,taptime:31.701333333333338},{type:"Tap",x:777,y:631,taptime:32},{type:"Tap",x:1201,y:602,taptime:32.384},{type:"Tap",x:844,y:1016,taptime:32.59733333333333},{type:"Tap",x:833,y:184,taptime:33.024},{type:"Tap",x:412,y:530,taptime:33.536},{type:"Tap",x:756,y:642,taptime:33.83466666666667},{type:"Tap",x:1199,y:631,taptime:34.21866666666667},{type:"Tap",x:813,y:986,taptime:34.47466666666667},{type:"Tap",x:786,y:168,taptime:34.944},{type:"Tap",x:351,y:607,taptime:37.205333333333336},{type:"Tap",x:746,y:638,taptime:37.54666666666667},{type:"Tap",x:1304,y:637,taptime:37.93066666666667},{type:"Tap",x:811,y:1012,taptime:38.144},{type:"Tap",x:765,y:194,taptime:38.61333333333334},{type:"Tap",x:356,y:617,taptime:39.08266666666667},{type:"Tap",x:768,y:618,taptime:39.38133333333334},{type:"Tap",x:1275,y:623,taptime:39.72266666666667},{type:"Tap",x:872,y:1017,taptime:39.97866666666667},{type:"Tap",x:823,y:232,taptime:40.448},{type:"Tap",x:348,y:627,taptime:40.91733333333333},{type:"Tap",x:767,y:619,taptime:41.25866666666667},{type:"Tap",x:1282,y:632,taptime:41.64266666666667},{type:"Tap",x:797,y:1035,taptime:41.89866666666667},{type:"Tap",x:786,y:210,taptime:42.368},{type:"Tap",x:339,y:580,taptime:42.79466666666667},{type:"Tap",x:354,y:657,taptime:44.629333333333335},{type:"Tap",x:746,y:622,taptime:44.928000000000004},{type:"Tap",x:1274,y:637,taptime:45.312000000000005},{type:"Tap",x:789,y:1009,taptime:45.525333333333336},{type:"Tap",x:776,y:198,taptime:45.952},{type:"Tap",x:389,y:656,taptime:46.42133333333334},{type:"Tap",x:760,y:641,taptime:46.76266666666667},{type:"Tap",x:1195,y:645,taptime:47.14666666666667},{type:"Tap",x:851,y:1073,taptime:47.36},{type:"Tap",x:781,y:241,taptime:47.82933333333334},{type:"Tap",x:375,y:637,taptime:48.34133333333333},{type:"Tap",x:761,y:648,taptime:48.64},{type:"Tap",x:1247,y:613,taptime:49.024},{type:"Tap",x:840,y:1059,taptime:49.23733333333333},{type:"Tap",x:819,y:173,taptime:49.70666666666667},{type:"Tap",x:364,y:662,taptime:50.13333333333333},{type:"Tap",x:133,y:151,taptime:52.010666666666665},{type:"Tap",x:1428,y:233,taptime:52.053333333333335},{type:"Tap",x:1395,y:1068,taptime:52.522666666666666},{type:"Tap",x:309,y:1003,taptime:52.522666666666666},{type:"Tap",x:937,y:296,taptime:52.949333333333335},{type:"Tap",x:567,y:224,taptime:52.992000000000004},{type:"Tap",x:945,y:897,taptime:53.376000000000005},{type:"Tap",x:602,y:852,taptime:53.41866666666667},{type:"Tap",x:1299,y:161,taptime:53.845333333333336},{type:"Tap",x:178,y:92,taptime:53.888},{type:"Tap",x:1286,y:979,taptime:54.31466666666667},{type:"Tap",x:236,y:899,taptime:54.31466666666667},{type:"Tap",x:996,y:393,taptime:54.784},{type:"Tap",x:602,y:322,taptime:54.784},{type:"Tap",x:977,y:846,taptime:55.21066666666667},{type:"Tap",x:647,y:775,taptime:55.21066666666667},{type:"Tap",x:226,y:189,taptime:55.68000000000001},{type:"Tap",x:1250,y:237,taptime:55.68000000000001},{type:"Tap",x:1266,y:954,taptime:56.14933333333333},{type:"Tap",x:237,y:837,taptime:56.14933333333333},{type:"Tap",x:1015,y:367,taptime:56.61866666666667},{type:"Tap",x:633,y:329,taptime:56.61866666666667},{type:"Tap",x:976,y:773,taptime:57.04533333333333},{type:"Tap",x:610,y:758,taptime:57.04533333333333},{type:"Tap",x:261,y:203,taptime:57.51466666666667},{type:"Tap",x:1252,y:244,taptime:57.51466666666667},{type:"Tap",x:1318,y:979,taptime:57.983999999999995},{type:"Tap",x:248,y:937,taptime:57.983999999999995},{type:"Tap",x:944,y:426,taptime:58.495999999999995},{type:"Tap",x:587,y:364,taptime:58.53866666666667},{type:"Tap",x:958,y:815,taptime:58.92266666666667},{type:"Tap",x:619,y:775,taptime:58.92266666666667},{type:"Tap",x:1251,y:230,taptime:59.349333333333334},{type:"Tap",x:299,y:190,taptime:59.391999999999996},{type:"Tap",x:1314,y:983,taptime:59.81866666666667},{type:"Tap",x:273,y:934,taptime:59.81866666666667},{type:"Tap",x:972,y:448,taptime:60.33066666666667},{type:"Tap",x:644,y:427,taptime:60.33066666666667},{type:"Tap",x:1008,y:828,taptime:60.757333333333335},{type:"Tap",x:655,y:822,taptime:60.757333333333335},{type:"Tap",x:659,y:873,taptime:60.8},{type:"Tap",x:291,y:191,taptime:61.184},{type:"Tap",x:1269,y:234,taptime:61.226666666666674},{type:"Tap",x:242,y:987,taptime:61.653333333333336},{type:"Tap",x:1303,y:1021,taptime:61.696},{type:"Tap",x:993,y:487,taptime:62.122666666666674},{type:"Tap",x:587,y:372,taptime:62.165333333333336},{type:"Tap",x:1008,y:830,taptime:62.592},{type:"Tap",x:647,y:802,taptime:62.592},{type:"Tap",x:1287,y:256,taptime:63.01866666666666},{type:"Tap",x:238,y:247,taptime:63.01866666666666},{type:"Tap",x:1359,y:1049,taptime:63.53066666666666},{type:"Tap",x:221,y:1011,taptime:63.53066666666666},{type:"Tap",x:1014,y:471,taptime:64.04266666666666},{type:"Tap",x:588,y:407,taptime:64.04266666666666},{type:"Tap",x:1007,y:858,taptime:64.42666666666666},{type:"Tap",x:641,y:852,taptime:64.46933333333334},{type:"Tap",x:1301,y:296,taptime:64.896},{type:"Tap",x:176,y:233,taptime:64.896},{type:"Tap",x:1304,y:1073,taptime:65.36533333333334},{type:"Tap",x:297,y:1056,taptime:65.408},{type:"Tap",x:1007,y:513,taptime:65.87733333333334},{type:"Tap",x:666,y:490,taptime:65.87733333333334},{type:"Tap",x:1027,y:857,taptime:66.304},{type:"Tap",x:651,y:852,taptime:66.34666666666666},{type:"Tap",x:356,y:706,taptime:66.816},{type:"Tap",x:336,y:586,taptime:70.48533333333333},{type:"Tap",x:692,y:664,taptime:70.784},{type:"Tap",x:1209,y:644,taptime:71.12533333333333},{type:"Tap",x:335,y:627,taptime:72.32000000000001},{type:"Tap",x:786,y:628,taptime:72.66133333333333},{type:"Tap",x:1267,y:604,taptime:73.00266666666667},{type:"Tap",x:275,y:636,taptime:74.112},{type:"Tap",x:707,y:636,taptime:74.496},{type:"Tap",x:1218,y:613,taptime:74.83733333333333},{type:"Tap",x:819,y:189,taptime:75.52},{type:"Tap",x:308,y:645,taptime:76.032},{type:"Tap",x:747,y:634,taptime:76.33066666666667},{type:"Tap",x:1283,y:695,taptime:76.672},{type:"Tap",x:730,y:123,taptime:77.35466666666667},{type:"Tap",x:344,y:625,taptime:77.86666666666667},{type:"Tap",x:712,y:621,taptime:78.16533333333334},{type:"Tap",x:1198,y:674,taptime:78.50666666666667},{type:"Tap",x:809,y:999,taptime:78.76266666666668},{type:"Tap",x:771,y:108,taptime:79.18933333333334},{type:"Tap",x:219,y:613,taptime:79.70133333333334},{type:"Tap",x:682,y:623,taptime:80},{type:"Tap",x:1293,y:568,taptime:80.384},{type:"Tap",x:874,y:962,taptime:80.59733333333334},{type:"Tap",x:783,y:197,taptime:81.06666666666666},{type:"Tap",x:279,y:721,taptime:81.536},{type:"Tap",x:623,y:680,taptime:81.87733333333334},{type:"Tap",x:1183,y:659,taptime:82.21866666666666},{type:"Tap",x:765,y:1025,taptime:82.47466666666666},{type:"Tap",x:749,y:250,taptime:82.90133333333334},{type:"Tap",x:245,y:726,taptime:83.41333333333334},{type:"Tap",x:679,y:666,taptime:83.712},{type:"Tap",x:1178,y:626,taptime:84.05333333333334},{type:"Tap",x:727,y:989,taptime:84.352},{type:"Tap",x:755,y:175,taptime:84.77866666666667},{type:"Tap",x:279,y:669,taptime:85.248},{type:"Tap",x:673,y:622,taptime:85.54666666666667},{type:"Tap",x:1175,y:604,taptime:85.93066666666667},{type:"Tap",x:824,y:1e3,taptime:86.144},{type:"Tap",x:761,y:200,taptime:86.61333333333333},{type:"Tap",x:270,y:632,taptime:87.08266666666667},{type:"Tap",x:1221,y:632,taptime:88.02133333333333}],name:"Demolevel 2",author:"coloreddrums",track:{title:"Don't Wanna Dance (Clip)",artist:"_MÃ_"}}],levelcontainer}),define("views/chooselevel",["jquery","underscore","backbone","util/levelvalidator","text!templates/leveloverview.html","views/levelpanel","views/PlayView","levelcontainer","app"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({render:function(){n.history.navigate("chooselevel",{trigger:!1,replace:!0});var r=t.template(i,{});this.$el.html(r),this.levelpanelviews=[];var o=e("#levelcontainer");o.html("");for(var a=0;a<u.length;a++){var f=u[a],l=new s;l.render(f),o.append(l.el),this.levelpanelviews.push(l)}},events:{"click #startlevel":"startlevel","click #demolevel":"startdemo","click #devbutton":"devaction","click #easy":"starteasy","click #intermediate":"startintermediate","click #hard":"starthard"},startlevel:function(){r.validate(e("#leveljsoninput").val())?a.startlevel(JSON.parse(e("#leveljsoninput").val())):this.invalidLevelJSON()},invalidLevelJSON:function(){this.$("#alert_invalidlevel").slideDown()}});return f}),define("text!templates/404.html",[],function(){return'<div class="container">\r\n    <div class="alert alert-warning alert-dismissable" id="alert404" style="display:none">\r\n        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>\r\n        <strong>Sorry!</strong> The page you requested could not be found. You\'ve been redirected to the home page.\r\n    </div>\r\n</div>'}),define("views/PageNotFoundView",["jquery","underscore","backbone","text!templates/404.html"],function(e,t,n,r){var i=n.View.extend({el:"#abovecontent",render:function(){var i=t.template(r,{});this.$el.html(i),e("#alert404").slideDown(),n.history.bind("route",this.updateState)},updateState:function(t,n){if(n!="notfound"){console.log(n);var r=e("#alert404");r!=null&&r.slideUp()}}});return i}),define("text!templates/legal.html",[],function(){return'\r\n<div class="container">\r\n<h2>Person responsible for content in accordance with 55 Abs. 2 RStV</h2>\r\n    <br>\r\n    Hermann Stolte\r\n    <br><br>\r\n\r\n\r\n<h2>Disclaimer</h2>\r\nAccountability for content\r\nThe contents of our pages have been created with the utmost care. However, we cannot guarantee the contents\' accuracy, completeness or topicality. According to statutory provisions, we are furthermore responsible for our own content on these web pages. In this context, please note that we are accordingly not obliged to monitor merely the transmitted or saved information of third parties, or investigate circumstances pointing to illegal activity. Our obligations to remove or block the use of information under generally applicable laws remain unaffected by this as per Â§Â§ 8 to 10 of the Telemedia Act (TMG).\r\n\r\nAccountability for links\r\nResponsibility for the content of external links (to web pages of third parties) lies solely with the operators of the linked pages. No violations were evident to us at the time of linking. Should any legal infringement become known to us, we will remove the respective link immediately.\r\n\r\nCopyright\r\nOur web pages and their contents are subject to German copyright law. Unless expressly permitted by law (Â§ 44a et seq. of the copyright law), every form of utilizing, reproducing or processing works subject to copyright protection on our web pages requires the prior consent of the respective owner of the rights. Individual reproductions of a work are allowed only for private use, so must not serve either directly or indirectly for earnings. Unauthorized utilization of copyrighted works is punishable (Â§ 106 of the copyright law).\r\n\r\n<i>Source: </i><a href="http://www.twigg.de" target="_blank">twiggs translations</a>\r\n\r\n<h3 id="dependencies">Third-party involvement</h3>\r\n<p>TouchTheBeat uses the following <strong>third party services</strong>:</p>\r\n<ul>\r\n    <li><strong>\'audio streaming service\' offered by SoundCloud Limited</strong>, a company incorporated under the laws of England &amp; Wales and with its main place of business at Rheinsberger Str. 76/77, 10115 Berlin, Germany. More information about SoundCloud is available here: https://soundcloud.com/imprint </li>\r\n</ul>\r\n<p>I may not be associated with any of these third party services or content provided by them.</p>\r\n<p>TouchTheBeat uses and contains the following <strong>software components</strong> under their respective licenses:</p>\r\n<ul>\r\n    <li><strong>jQuery</strong> JavaScript Library v1.10.1, http://jquery.com/, Includes Sizzle.js http://sizzlejs.com/ Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors Released under the MIT license</li>\r\n    <li><strong>Underscore.js</strong> 1.6.0 http://underscorejs.org (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters &amp; Editors MIT license.</li>\r\n    <li><strong>Backbone.js</strong> 1.1.2 http://backbonejs.org (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters &amp; Editors MIT license</li>\r\n    <li><strong>RequireJS</strong> 2.1.13 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved. Available via the MIT or new BSD license. see: http://github.com/jrburke/requirejs for details</li>\r\n    <li><strong>RequireJS text</strong> 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved. Available via the MIT or new BSD license. see: http://github.com/requirejs/text for details</li>\r\n    <li><strong>Bootstrap</strong> v3.2.0 (http://getbootstrap.com) Copyright 2011-2014 Twitter, Inc. Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)</li>\r\n    <li><strong>Snap.svg</strong> 0.3.0 Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved. Licensed under the Apache License, Version 2.0 ; http://www.apache.org/licenses/LICENSE-2.0</li>\r\n    <li><strong>TV4.js</strong> Author: Geraint Luff and others Year: 2013 This code is released into the "public domain" by its auth</li>\r\n\r\n</ul>\r\n\r\n<h2>Privacy Policy</h2>\r\n    Google Analytics is a web analysis service provided by Google. Google utilizes the data collected to track and examine the use of dev.coloreddrums.com/ttb, to prepare reports on its activities and share them with other Google services.\r\n    Google may use the data collected to contextualize and personalize the ads of its own advertising network.\r\n\r\n    Personal data collected: Cookie and Usage Data. Place of processing: USA. Find Google\'s <a href="http://www.google.com/intl/en/policies/privacy/" target="_blank">privacy policy here</a>.\r\n    Find information on an opt-out option provided by Google <a href="//tools.google.com/dlpage/gaoptout" target="_blank">here</a>.\r\n</div>'}),define("views/legal",["jquery","underscore","backbone","text!templates/legal.html","app"],function(e,t,n,r,i){var s=n.View.extend({el:"#content",render:function(){var e=t.template(r,{});this.$el.html(e)}});return s}),define("text!templates/highscore.html",[],function(){return'<div class="container">  \r\n<!-- Main jumbotron for a primary marketing message or call to action -->\r\n    <div class="jumbotron">\r\n      <div class="container">\r\n        <h1>Level Finished!</h1>\r\n        <p>Congratulations! You finished <%= levelname %> with <strong><%= highscore %></strong>.</p>\r\n        <p><button class="btn btn-primary btn" type="button" id="btn_playagain">Play again!</button><button class="btn btn-default" id="btn_gotoChooseLevelView">Return to Level-Overview</button></p>\r\n      </div>\r\n    </div>\r\n    </div>\r\n'}),define("views/highscore",["jquery","underscore","backbone","text!templates/highscore.html","app","util/analytics","bootstrap"],function(e,t,n,r,i,s){var o=n.View.extend({el:"#content",events:{"click #btn_gotoChooseLevelView":"gotoChooseLevelView","click #btn_playagain":"playagain"},render:function(e){n.history.navigate("highscore",!1),this.game=e;var i=t.template(r,{highscore:this.game.highscore,levelname:this.game.level.levelname});this.$el.html(i)},gotoChooseLevelView:function(){s.trackAction("highscoreview","click button","gotoChooseLevelview"),n.history.navigate("chooselevel",!0)},playagain:function(){s.trackAction("highscoreview","click button","playagain"),console.log(this.game),i.startlevel(this.game.level)}});return o}),define("text!templates/levelbuilder/audioselector.html",[],function(){return'<div class="container">\r\n    <div class="alert alert-info alert-dismissable" id="alert_tracknotfound" style="display:none;">\r\n        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>\r\n        <div id="alert_tracknotfound_text">\r\n            <strong>Track not found!</strong>\r\n            Use a Soundcloud URL in this format: https://soundcloud.com/artist/track.\r\n        </div>\r\n    </div>\r\n    <div id="trackselection">\r\n        <h3>Enter a link to a\r\n            <a href="http://soundcloud.com/" target="_blank">Soundcloud</a>\r\n            -Track to start:</h3>\r\n\r\n        <div class="input-group">\r\n            <input type="text" class="form-control" id="input_entertrack"\r\n                   placeholder="Paste Soundcloud URL here (https://soundcloud.com/artist/track)"/>\r\n            <span class="input-group-btn">\r\n                <button class="btn btn-default" type="button" id="btn_recommendedtrack">\r\n                    <span class=\'glyphicon glyphicon-random\'></span>\r\n                </button>\r\n                <button class="btn btn-primary" type="button" id="btn_entertrack">Select this track!</button>\r\n            </span>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row" id="trackinfo" style="display: none">\r\n        <div class="col-sm-4" id="trackcontainer">\r\n        </div>\r\n        <div class="col-sm-8" id="instructions">\r\n            <h3>Great!</h3>\r\n\r\n            <p>You selected a track from Soundcloud. You can now add the following GameObjects by pressing the\r\n                corresponding keys in time:</p>\r\n            <dl class="dl-horizontal">\r\n                <dt>TapObject</dt>\r\n                <dd>\r\n                    <kbd>space</kbd>\r\n                </dd>\r\n                <dt>HoldObject</dt>\r\n                <dd>\r\n                    <em>soon ...</em>\r\n                </dd>\r\n                <dt>MoveObject</dt>\r\n                <dd>\r\n                    <em>soon ...</em>\r\n                </dd>\r\n                <dt></dt>\r\n                <dd>\r\n                    <em>more to come ...</em>\r\n                </dd>\r\n            </dl>\r\n\r\n            <button class="btn btn-primary pull-right" type="button" id="btn_gameobjectrecorder">I\'m ready to roll!\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>'}),define("text!templates/trackpanel.html",[],function(){return'<div class="panel panel-default">\r\n    <div class="panel-content media">\r\n            <a class="pull-left" href="<%= trackurl %>"  alt="<%= track %>">\r\n                <img class="media-object" src="<%= imageurl %>" alt="<%= track %>"></a>\r\n            <div class="media-body">\r\n                <div class="vcenter">\r\n                    <h4 class="media-heading"><a href="<%= trackurl %>"><%= track %></a></h4>\r\n                    <div id="infoArtist"><a href="<%= artisturl %>"><%= artist %></a></div>\r\n                </div>\r\n            </div>\r\n    </div>\r\n</div>'}),define("views/levelbuilder/audioselector",["jquery","underscore","backbone","app","text!templates/levelbuilder/audioselector.html","text!templates/trackpanel.html","util/SoundcloudLoader","util/scripts","bootstrap"],function(e,t,n,r,i,s,o){var u=n.View.extend({el:"#content",initialize:function(){this.randomtracks=["https://soundcloud.com/maxfrostmusic/white-lies","https://soundcloud.com/greco-roman/roosevelt-sea-1","https://soundcloud.com/t-e-e-d/garden","https://soundcloud.com/homoheadphonico/phantogram-don-t-move","https://soundcloud.com/etagenoir/parov-stelar-catgroove","https://soundcloud.com/fosterthepeoplemusic/pumpedupkicks","https://soundcloud.com/benkhan/savage","https://soundcloud.com/kooksmusic/forgive-forget"]},render:function(n){var r=t.template(i,{});this.$el.html(r),n!=null&&(e("#input_entertrack").val(n),this.enteredTrack())},onClose:function(){},events:{"click #btn_entertrack":"enteredTrack","click #btn_recommendedtrack":"selectedRandomTrack","click #btn_gameobjectrecorder":"openGameObjectRecorder"},enteredTrack:function(){if(e("#input_entertrack").val()==""){this.loading_error();return}o.loadStream(e("#input_entertrack").val(),this.loading_success.bind(this),this.loading_error.bind(this))},selectedRandomTrack:function(){var t=this.randomtracks[Math.floor(Math.random()*this.randomtracks.length)];console.log("random: "+t),e("#input_entertrack").val(t),this.enteredTrack()},openGameObjectRecorder:function(){r.setFullScreenContent(r.router.levelbuilder_gameobjectrecorderview,this.sound)},loading_success:function(t){this.sound=t,e("#alert_tracknotfound").slideUp(),n.history.navigate("/buildlevel/"+encodeURIComponent(e("#input_entertrack").val())),this.updateTrackPanel({imageurl:this.sound.artwork_url?this.sound.artwork_url:this.sound.user.avatar_url,artisturl:this.sound.user.permalink_url,trackurl:this.sound.permalink_url,artist:this.sound.user.username,track:this.sound.title}),e("#trackinfo").fadeIn(),e("#trackselection").slideUp()},onAudioError:function(){this.audioisplaying=!1,this.loading_error("There was an error during audio playback. Sorry!"),this.audiocontroller.dispose()},loading_error:function(e){console.log("error"),this.$("#alert_tracknotfound_text").html(e),this.$("#alert_tracknotfound").slideDown()},updateTrackPanel:function(r){var i=t.template(s,r);e("#trackcontainer").html(i),e("#trackinfo").fadeIn()}});return u}),define("text!templates/levelbuilder/gameobjectrecorder.html",[],function(){return'<div id="gamerecorder" class="svgcontainer">\r\n    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%" viewBox="0 0 1600 1200" id="svg">\r\n    </svg>\r\n</div>\r\n\r\n'}),define("views/levelbuilder/gameobjectrecorder",["jquery","underscore","backbone","snap","gameclasses/TapObject","gameclasses/Surface","views/audio","util/SoundcloudLoader","text!templates/levelbuilder/gameobjectrecorder.html","app"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({el:"#body",onClose:function(){this.audiocontroller&&(this.audiocontroller.onClose(),this.audiocontroller.dispose())},render:function(e){this.sound=e,this.gameobjects=[],this.audiocontroller&&this.audiocontroller.dispose();var n=t.template(a,{});this.$el.html(n),this.audiocontroller=new o,this.audiocontroller.setCallbacks(this.onAudioStarted.bind(this),this.recordingfinished.bind(this),this.onAudioReady.bind(this),this.onAudioError.bind(this)),this.audiocontroller.render(u.getStreamUrl(this.sound.stream_url),!0),this.surface=new s({bgcolor:"#222222"}),this.surface.showLoadingIndicator(),this.svgelem=document.getElementById("svg"),this.surface.getRootRect().touchstart(function(e){if(this.isrecording){console.log("touch on surface");var t=e.changedTouches[0],n=this.svgelem.createSVGPoint();n.x=t.pageX,n.y=t.pageY;var r=e.target.getScreenCTM();(r=r.inverse())?(n=n.matrixTransform(r),console.log(JSON.stringify(n)),this.addTapObject(this.audiocontroller.getCurrentTime(),Math.floor(n.x),Math.floor(n.y)),console.log(this.gameobjects[this.gameobjects.length-1])):console.error("error retrieving position")}}.bind(this))},addTapObject:function(e,t,n){this.gameobjects.push({type:"Tap",x:t,y:n,taptime:e})},onAudioReady:function(){this.surface.hideLoadingIndicator(),this.surface.requestStartFromUser(this.audiocontroller.start.bind(this.audiocontroller))},onAudioStarted:function(){this.isrecording=!0},onAudioError:function(){this.isrecording=!1,console.error("Audio error!!!!!"),this.audiocontroller.dispose()},recordingfinished:function(){this.isrecording=!1,console.log("finished"),f.setContent(f.router.levelbuilder_metadataview,this.sound,this.gameobjects)}});return l}),define("text!templates/levelbuilder/metadata.html",[],function(){return'<div class="container">\r\n    <div class="col-sm-9" id="publish" style="display: none">\r\n        <h3>Allright!\r\n            <small>Let\'s finish this.</small>\r\n        </h3>\r\n        <p>All your level-content has been recorded correctly. You can now give a name to your level and play it.</p>\r\n\r\n        <div class="input-group">\r\n            <input type="text" class="form-control" id="levelname"/>\r\n            <span class="input-group-btn">\r\n                <button class="btn btn-primary" type="button" id="btn_publish">Publish!</button>\r\n            </span>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="col-sm-9" id="finished" style="display: none">\r\n        <h3>Congratulations!\r\n            <small>Your level is ready now.</small>\r\n        </h3>\r\n        <p>You can save your level by copying the data below to the destination of your choice. Then, you can start your\r\n            level right away by pressing the button below.</p>\r\n\r\n        <p><textarea id="leveljsoncontainer" style="width:100%; resize:none" readonly rows="4"\r\n                     onclick="this.focus();this.select()"></textarea></p>\r\n\r\n        <p>\r\n            <button class="btn btn-primary pull-right" type="button" id="btn_playnow">Play now!</button>\r\n        </p>\r\n    </div>\r\n\r\n</div>'}),define("views/levelbuilder/metadataview",["jquery","underscore","backbone","app","text!templates/levelbuilder/metadata.html","util/scripts","bootstrap"],function(e,t,n,r,i){var s=n.View.extend({el:"#content",initialize:function(){},render:function(n,r){console.log(r),console.log(n),this.sound=n,this.gameobjects=r;var s=t.template(i,{});this.$el.html(s),e("#publish").fadeIn()},onClose:function(){},events:{"click #btn_publish":"openPublish","click #btn_playnow":"playLevelNow"},openPublish:function(){this.createLevel(),e("#leveljsoncontainer").html(JSON.stringify(this.level)),e("#publish").slideUp(),e("#finished").slideDown()},playLevelNow:function(){r.startlevel(this.level)},createLevel:function(){var t={};t.audio={},t.audio.stream_url=this.sound.stream_url,t.audio.permalink_url=this.sound.permalink_url,t.gameobjects=this.gameobjects,t.name=e("#levelname").val(),t.track={},t.track.title=this.sound.title,t.track.artist=this.sound.user.username,this.level=t}});return s}),define("router",["jquery","underscore","backbone","app","util/analytics","views/menu","views/home","views/chooselevel","views/applicationwithmenu","views/PageNotFoundView","views/legal","views/PlayView","views/highscore","views/levelbuilder/audioselector","views/levelbuilder/gameobjectrecorder","views/levelbuilder/metadataview"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=n.Router.extend({routes:{"":"home",chooselevel:"chooselevel",buildlevel:"buildlevel","buildlevel/:soundcloudurl":"buildlevel",legal:"legal",playlevel:"chooselevel",highscore:"chooselevel","*notfound":"notfound"},init:function(){this.applicationwithmenuview=new a,this.homeview=new o,this.chooselevelview=new u,this.pagenotfoundview=new f,this.legalview=new l,this.playlevelview=new c,this.highscoreview=new h,this.levelbuilder_audioselectorview=new p,this.levelbuilder_gameobjectrecorderview=new d,this.levelbuilder_metadataview=new v,this.on("route:home",function(){r.setContent(this.homeview)}),this.on("route:chooselevel",function(){r.setContent(this.chooselevelview)}),this.on("route:buildlevel",function(e){r.setContent(this.levelbuilder_audioselectorview,e)}),this.on("route:notfound",function(e){console.log("No route:",e),r.setContent(this.homeview),this.pagenotfoundview.render()}),this.on("route:legal",function(){r.setContent(this.legalview)})},current:function(){var e=this,r=n.history.fragment,i=t.pairs(e.routes),s=null,o=null,u;return u=t.find(i,function(n){return s=t.isRegExp(n[0])?n[0]:e._routeToRegExp(n[0]),s.test(r)}),u&&(o=e._extractParameters(s,r),s=u[1]),{route:s,fragment:r,params:o}}}),g=function(){var e=new m;return e};return{initialize:g}}),require.config({paths:{jquery:["//code.jquery.com/jquery-2.1.1.min","lib/jquery"],underscore:["//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min","lib/underscore"],backbone:["//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min","lib/backbone"],text:"lib/text",templates:"../templates",bootstrap:["//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min","lib/bootstrap"],snap:["//cdn.jsdelivr.net/snap.svg/0.3.0/snap.svg-min","lib/snap.svg"],"google-analytics":["//www.google-analytics.com/analytics","lib/analytics"],tv4:"lib/tv4",schema:"schema"},shim:{bootstrap:["jquery"],snap:{exports:"Snap"},"google-analytics":{exports:"ga"}}}),require(["jquery","underscore","backbone","router","app","bootstrap"],function(e,t,n,r,i){n.View.prototype.dispose=function(){this.unbind(),this.undelegateEvents()},i.router=r.initialize(),i.router.init(),n.history.start(),console.info("loading of TouchTheBeat complete")}),define("main",function(){});